
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Opbasm PicoBlaze macro library reference &#8212; Opbasm 1.3.10 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" href="../_static/project.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tty/tty-player.min.css" type="text/css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Opbsim" href="opbsim.html" />

   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

<script src="_static/tty/webcomponents-lite.min.js"></script>
<script src="_static/tty/term.min.js"></script>
<script src="_static/tty/tty-player.min.js"></script>

<style>
	.terminal-cursor {
		color: #000;
		background: green;
	}
	.terminal, .title {
		font-size:x-small;
	}
</style>


  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="opbasm-picoblaze-macro-library-reference">
<h1>Opbasm PicoBlaze macro library reference<a class="headerlink" href="#opbasm-picoblaze-macro-library-reference" title="Permalink to this heading">¶</a></h1>
<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.abs">
<span class="sig-name descname"><span class="pre">abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to make positive</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result is in the same register</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">evalh(</span><span class="o">-</span><span class="m">10</span><span class="nb">)</span>
<span class="nb">abs(</span><span class="s">s0</span><span class="nb">)</span>             <span class="c">; Result is 10</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.abs16">
<span class="sig-name descname"><span class="pre">abs16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.abs16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit absolute value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to make positive</p></li>
<li><p><strong>Arg2</strong> – LSB register to make positive</p></li>
</ul>
</dd>
</dl>
<p>Result is in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="o">-</span><span class="m">1000</span><span class="nb">)</span>
<span class="nb">abs16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>      <span class="c">; s1, s0 contain +1000</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="m">1000</span><span class="nb">)</span>
<span class="nb">abs16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>      <span class="c">; s1, s0 contain +1000</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.add16">
<span class="sig-name descname"><span class="pre">add16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.add16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit addition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1 register</p></li>
<li><p><strong>Arg2</strong> – LSB1 register</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to add to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">add16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; s1,s0 += 0x1234</span>
<span class="nb">add16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>  <span class="c">; s1,s0 += s3,s2</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.addstack">
<span class="sig-name descname"><span class="pre">addstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.addstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate local space on the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Number of values to add to the stack or a register</p></li>
</ul>
</dd>
</dl>
<p>You can use the added space for a local variable storage on the stack. This avoids
the need to have static stratchpad memory allocations. Use <a class="reference internal" href="#pb.dropstack" title="dropstack"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">dropstack()</span></code></a> to
restore the stack pointer.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">addstack(</span><span class="m">2</span><span class="nb">)</span>  <span class="c">; Add 2 values</span>
<span class="nb">addstack(</span><span class="s">s1</span><span class="nb">)</span> <span class="c">; Add number of values from s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.and16">
<span class="sig-name descname"><span class="pre">and16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.and16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical AND.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1</p></li>
<li><p><strong>Arg2</strong> – LSB1</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to AND to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x787F</span><span class="nb">)</span>
<span class="nb">and16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0FC0</span><span class="nb">)</span>  <span class="c">; Result is 0x0840</span>
<span class="nb">and16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>   <span class="c">; (s1,s0) AND (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_black">
<span class="sig-name descname"><span class="pre">ansi_black</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_black" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating color text.</p>
<p>The resulting string contains backslash escapes that must be processed
by <a class="reference internal" href="#pb.cstr" title="cstr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">cstr()</span></code></a> or <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">estr()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">ansi_red</span>`foobar&#39;ansi_reset       ; red text
<span class="nb">ansi_red(</span><span class="s">bold</span><span class="nb">)</span>`foobar&#39;ansi_reset ; bold/bright red text
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_blue">
<span class="sig-name descname"><span class="pre">ansi_blue</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_blue" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating blue text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_cyan">
<span class="sig-name descname"><span class="pre">ansi_cyan</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_cyan" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating cyan text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_green">
<span class="sig-name descname"><span class="pre">ansi_green</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_green" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating green text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_magenta">
<span class="sig-name descname"><span class="pre">ansi_magenta</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_magenta" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating magenta text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_red">
<span class="sig-name descname"><span class="pre">ansi_red</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_red" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating red text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_reset">
<span class="sig-name descname"><span class="pre">ansi_reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape code for clearing pervious colors.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_white">
<span class="sig-name descname"><span class="pre">ansi_white</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_white" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating white text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ansi_yellow">
<span class="sig-name descname"><span class="pre">ansi_yellow</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ansi_yellow" title="Permalink to this definition">¶</a></dt>
<dd><p>ANSI escape codes for generating yellow text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional argument of “bold” will activate bold/bright text</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ansi_black" title="ansi_black"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ansi_black()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.argc">
<span class="sig-name descname"><span class="pre">argc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.argc" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Argument list to count</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">argc(</span><span class="s">a</span><span class="p">,</span><span class="s">b</span><span class="p">,</span><span class="s">c</span><span class="p">,</span><span class="s">d</span><span class="nb">)</span> <span class="c">; Expands to 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.asciiord">
<span class="sig-name descname"><span class="pre">asciiord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.asciiord" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to convert</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">asciiord(</span><span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must use m4 quotes on the string argument to avoid unwanted substitutions.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.break">
<span class="sig-name descname"><span class="pre">break</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.break" title="Permalink to this definition">¶</a></dt>
<dd><p>Break statement to exit from for(), while(), and dowhile() loops.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.calleq">
<span class="sig-name descname"><span class="pre">calleq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calleq" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to call</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.callge">
<span class="sig-name descname"><span class="pre">callge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callge" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if greater or equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to call</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s3</span><span class="p">,</span> <span class="mh">24</span>
<span class="nb">callge(</span><span class="s">greater</span><span class="nb">)</span>    <span class="c">; call if s3 &gt;= 24</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.calllt">
<span class="sig-name descname"><span class="pre">calllt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calllt" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if less than.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to call</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.callne">
<span class="sig-name descname"><span class="pre">callne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callne" title="Permalink to this definition">¶</a></dt>
<dd><p>Call if not equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to call</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s3</span><span class="p">,</span> <span class="mh">24</span>
<span class="nb">callne(</span><span class="s">not_equal</span><span class="nb">)</span>  <span class="c">; call if s3 != 24</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.callstring">
<span class="sig-name descname"><span class="pre">callstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.callstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated string function call operation (useful for PicoBlaze-3).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine to call for each character</p></li>
<li><p><strong>Arg2</strong> – Register used to hold characters (typically an argument to the subroutine)</p></li>
<li><p><strong>Arg3</strong> – String to split into characters</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">callstring(</span><span class="s">write_char</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">Expands</span> <span class="n">to</span>:
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;M&quot;</span>
   <span class="k">call</span> <span class="n">write_char</span>
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;y&quot;</span>
   <span class="k">call</span> <span class="n">write_char</span>
   ...
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.calltable">
<span class="sig-name descname"><span class="pre">calltable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.calltable" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated function call on a table of constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine to call for each byte</p></li>
<li><p><strong>Arg2</strong> – Temporary register for each constant</p></li>
<li><p><strong>Arg3-ArgN</strong> – Decimal values representing table bytes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">calltable(</span><span class="s">my_subroutine</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Pass DE,AD,BE,EF in repeated calls to my_subroutine</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.clearcy">
<span class="sig-name descname"><span class="pre">clearcy</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.clearcy" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the carry flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional temp register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">clearcy</span>
<span class="nb">clearcy(</span><span class="s">s0</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.clearmask">
<span class="sig-name descname"><span class="pre">clearmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.clearmask" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear mask bits in a register.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to modify</p></li>
<li><p><strong>Arg2</strong> – Mask value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">clearmask(</span><span class="s">s5</span><span class="p">,</span> <span class="nb">mask(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="nb">))</span>
<span class="nb">clearmask(</span><span class="s">s4</span><span class="p">,</span> <span class="mh">0xF1</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.colorize">
<span class="sig-name descname"><span class="pre">colorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.colorize" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap a string in ANSI color codes.</p>
<p>The resulting string contains backslash escapes that must be processed
by <a class="reference internal" href="#pb.cstr" title="cstr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">cstr()</span></code></a> or <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">estr()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to modify</p></li>
<li><p><strong>Arg2</strong> – ANSI color name (black, red, green, yellow, blue, magenta, cyan, and white)</p></li>
<li><p><strong>Arg3</strong> – Optional argument “bold” will select bold text</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">colorize(</span><span class="s">`foobar&#39;</span><span class="p">,</span> <span class="s">blue</span><span class="nb">)</span>      <span class="c">; Equivalent to ansi_blue`foobar&#39;ansi_reset</span>
<span class="nb">colorize(</span><span class="s">`foobar&#39;</span><span class="p">,</span> <span class="s">red</span><span class="p">,</span> <span class="s">bold</span><span class="nb">)</span> <span class="c">; Equivalent to ansi_red(bold)`foobar&#39;ansi_reset</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.compares">
<span class="sig-name descname"><span class="pre">compares</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.compares" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed compare.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register for left side of comparison</p></li>
<li><p><strong>Arg2</strong> – Register or constant for right side of comparison.
Constant is a number in m4 syntax and cannot be a named constant</p></li>
</ul>
</dd>
</dl>
<p>Carry flag is set in accordance with signed relation.</p>
<p>Zero flag is indeterminate. Use normal <a class="reference internal" href="language.html#inst-compare"><span class="std std-ref">compare</span></a> instruction for == and !=</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This calls the <a class="reference internal" href="#pb.setcy" title="setcy"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">setcy()</span></code></a> macro and depends on the tempreg</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">evalh(</span><span class="o">-</span><span class="m">20</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">42</span>
<span class="nb">compares(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>     <span class="c">; C flag is set because -20 &lt; 0x42</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.constlower">
<span class="sig-name descname"><span class="pre">constlower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.constlower" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a 16-bit constant and return its lower byte.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Constant to split</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">constlower(</span><span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; Expands to 0x34</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.constupper">
<span class="sig-name descname"><span class="pre">constupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.constupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a 16-bit constant and return its upper byte.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Constant to split</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">constupper(</span><span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; Expands to 0x12</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.continue">
<span class="sig-name descname"><span class="pre">continue</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.continue" title="Permalink to this definition">¶</a></dt>
<dd><p>Continue statement to restart a for(), while(), or dowhile() loop.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.cstr">
<span class="sig-name descname"><span class="pre">cstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.cstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes with a NUL terminator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to convert</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">estr()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.dec2pbhex">
<span class="sig-name descname"><span class="pre">dec2pbhex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dec2pbhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of decimal values to PicoBlaze hex format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Decimal values to convert</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">dec2pbhex(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">200</span><span class="nb">)</span>  <span class="c">; Expands to 01, 02, 64, C8</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.delay_cycles">
<span class="sig-name descname"><span class="pre">delay_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay for a number of instruction cycles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Number of instructions to delay</p></li>
</ul>
</dd>
</dl>
<p>This can generate two types of delay loops. The default is a recursive
delay implemented without any registers. For delays of 511 cycles or less
a more efficient loop can be generated if a loop count register is defined
first by calling the <a class="reference internal" href="#pb.use_delay_reg" title="use_delay_reg"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_delay_reg()</span></code></a> macro.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">delay_cycles(</span><span class="m">10</span><span class="nb">)</span> <span class="c">; Delay for 10 instructions (20 clock cycles)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.delay_ms">
<span class="sig-name descname"><span class="pre">delay_ms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay by milliseconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Milliseconds to delay</p></li>
<li><p><strong>Arg2</strong> – MSB register of delay counter</p></li>
<li><p><strong>Arg3</strong> – LSB register of delay counter</p></li>
<li><p><strong>Arg4</strong> – Optional number of instructions to deduct from the delay (default is 0)</p></li>
</ul>
</dd>
</dl>
<p>This delay will be cycle accurate if the requested delay is an integer multiple
of the clock period.
At 100 MHz, the max delay is 214 ms. It increases with lower clock frequencies.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>

<span class="nl">delay_5ms:</span> <span class="nb">delay_ms(</span><span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span> <span class="c">; Deduct 2 additional instructions to account for call and return</span>
           <span class="k">return</span>
...
<span class="k">call</span> <span class="n">delay_5ms</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.delay_us">
<span class="sig-name descname"><span class="pre">delay_us</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.delay_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Delay by microseconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Microseconds to delay</p></li>
<li><p><strong>Arg2</strong> – MSB register of delay counter</p></li>
<li><p><strong>Arg3</strong> – LSB register of delay counter</p></li>
<li><p><strong>Arg4</strong> – Optional number of instructions to deduct from the delay (default is 0)</p></li>
</ul>
</dd>
</dl>
<p>This delay will be cycle accurate if the requested delay is an integer multiple
of the clock period.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>

<span class="nl">delay_40us:</span> <span class="nb">delay_us(</span><span class="m">40</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
            <span class="k">return</span>
...
<span class="k">call</span> <span class="n">delay_40us</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.dowhile">
<span class="sig-name descname"><span class="pre">dowhile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dowhile" title="Permalink to this definition">¶</a></dt>
<dd><p>Do-while loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Boolean comparison expression</p></li>
<li><p><strong>Arg2</strong> – Code block for loop body</p></li>
</ul>
</dd>
</dl>
<p>The Boolean expression must be of the form: <code class="docutils literal notranslate"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;=, ==, !=, &amp;, or ~&amp;</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">15&#39;d</span>
<span class="nb">dowhile(</span><span class="s">s0</span> <span class="o">!=</span> <span class="m">10</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">P_foo</span>
                   <span class="s">sub</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.dropstack">
<span class="sig-name descname"><span class="pre">dropstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.dropstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop values stored on the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Number of values to drop from the stack or a register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">dropstack(</span><span class="m">2</span><span class="nb">)</span>  <span class="c">; Remove 2 values</span>
<span class="nb">dropstack(</span><span class="s">s1</span><span class="nb">)</span> <span class="c">; Remove number of values specified in s1 register</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.errmsg">
<span class="sig-name descname"><span class="pre">errmsg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.errmsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Print an error message and terminate m4.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – message string</p></li>
</ul>
</dd>
</dl>
<p>This prints a message with the file and line number where the macro was invoked for debugging.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">errmsg(</span><span class="s">`Bad</span> <span class="s">arguments</span> <span class="s">to</span> <span class="s">foo</span> <span class="s">macro&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.estr">
<span class="sig-name descname"><span class="pre">estr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.estr" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a string to a list of decimal ASCII codes without a NUL terminator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to convert</p></li>
</ul>
</dd>
</dl>
<p>The following C escape codes are translated to their ASCII value:</p>
<ul class="simple">
<li><p>\\  \</p></li>
<li><p>\n  NL\LF</p></li>
<li><p>\r  CR</p></li>
<li><p>\t  HT</p></li>
<li><p>\b  BS</p></li>
<li><p>\a  BEL</p></li>
<li><p>\e  ESC</p></li>
<li><p>\s  semicolon ;</p></li>
</ul>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">estr(</span><span class="s">`My</span> <span class="s">string\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103, 13, 10</span>
<span class="nb">cstr(</span><span class="s">`My</span> <span class="s">string\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 77, 121, 32, 115, 116, 114, 105, 110, 103, 13, 10, 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evala">
<span class="sig-name descname"><span class="pre">evala</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evala" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a 12-bit PicoBlaze address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expands to a PicoBlaze address literal with a comment listing the original expression</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evalb">
<span class="sig-name descname"><span class="pre">evalb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalb" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a PicoBlaze binary number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression or constant name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expands to a PicoBlaze binary literal with a comment listing the original expression</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evalc">
<span class="sig-name descname"><span class="pre">evalc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression with expansion of constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression or constant name</p></li>
<li><p><strong>Arg2</strong> – Optional numeric base to convert to (default is 10)</p></li>
<li><p><strong>Arg3</strong> – Optional minimum number of digits in result (default is 0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expands to a literal for the expression or constant</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evald">
<span class="sig-name descname"><span class="pre">evald</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evald" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as a PicoBlaze decimal number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression or constant name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expands to a PicoBlaze decimal literal with a comment listing the original expression</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">cname</span><span class="p">,</span> <span class="nb">evald(</span><span class="m">20</span> <span class="o">*</span> <span class="m">4</span> <span class="o">-</span> <span class="m">1</span><span class="nb">)</span>  --&gt;  constant cname, 79&#39;d
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evalh">
<span class="sig-name descname"><span class="pre">evalh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalh" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate m4 expression as an 8-bit PicoBlaze hex number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression or constant name</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Expands to a PicoBlaze hex literal with a comment listing the original expression</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">cname</span><span class="p">,</span>  <span class="nb">evalh(</span><span class="m">20</span> <span class="o">+</span> <span class="m">6</span><span class="nb">)</span>      --&gt;  constant cname,  1a
<span class="k">constant</span> <span class="n">cname2</span><span class="p">,</span> <span class="nb">evalh(</span><span class="m">250</span> <span class="o">+</span> <span class="m">6</span><span class="nb">)</span>     --&gt;  constant cname2, 01
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.evalx">
<span class="sig-name descname"><span class="pre">evalx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.evalx" title="Permalink to this definition">¶</a></dt>
<dd><p>Only evaluate valid expressions, otherwise reproduce the original text in the
first argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression or string literal</p></li>
<li><p><strong>Arg2</strong> – Optional numeric base to convert to (default is 10)</p></li>
<li><p><strong>Arg3</strong> – Optional minimum number of digits in result (default is 0)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">evalx(</span><span class="s">some_name</span><span class="nb">)</span>  --&gt; some_name
<span class="nb">evalx(</span><span class="m">1</span><span class="o">+</span><span class="m">3</span><span class="nb">)</span>        --&gt; 4
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.expr">
<span class="sig-name descname"><span class="pre">expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Expression evaluators
This is a family of macros that provide implementation of arithmetic expressions from
compact input notation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<p>val is one of:</p>
<ul class="simple">
<li><p>register</p></li>
<li><p>literal expression (with no internal spaces)</p></li>
<li><p>sp[addr] scratchpad adddress</p></li>
<li><p>spi[reg] indirect scratchpad address in register</p></li>
</ul>
<p>op is one of:</p>
<blockquote>
<div><dl class="simple">
<dt><cite>+ - * /</cite></dt><dd><p>add, subtract, multiply, divide</p>
</dd>
<dt><cite>&amp; | ^</cite></dt><dd><p>and, or, xor</p>
</dd>
<dt><cite>&lt;&lt; &gt;&gt;</cite></dt><dd><p>shift left, shift right (0-filled MSB)</p>
</dd>
<dt><cite>=:</cite></dt><dd><p>reverse assignment to register or scratchpad</p>
</dd>
</dl>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Operations are evaluated left to right with <strong>no precedence</strong></p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">expr(</span><span class="s">s0</span> <span class="o">:=</span> <span class="s">s1</span> <span class="o">+</span> <span class="s">s2</span> <span class="o">-</span> <span class="s">s3</span> <span class="o">&gt;&gt;</span> <span class="m">4</span> <span class="o">=:</span> <span class="s">sp[M_value]</span><span class="nb">)</span>
  <span class="k">Arithmetic</span> <span class="n">is</span> <span class="n">performed</span> <span class="n">on</span> <span class="n">s0</span> <span class="n">and</span> <span class="n">the</span> <span class="n">result</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">scratchpad</span> <span class="n">at</span> <span class="n">M_value</span>
  <span class="k">s0</span> &lt;= s1, s0 &lt;= s0 + s2, s0 &lt;= s0 - s3, s0 &lt;= s0 &gt;&gt; 4, sp[M_value] &lt;= s0

<span class="nb">expr(</span><span class="s">s1</span> <span class="o">:=</span> <span class="s">s4</span> <span class="o">+</span> <span class="s">(28*4-1</span><span class="nb">)</span>)
  <span class="k">s1</span> &lt;= s4, s1 &lt;= s1 + 111   Constant expressions must have no spaces
</pre></div>
</div>
<p>Summary of expression macros:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Target x operand</p></th>
<th class="head"><p>Supported operators</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>expr</p></td>
<td><p>8x8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>exprs</p></td>
<td><p>8x8</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td><p>(signed *, /, and &gt;&gt;)</p></td>
</tr>
<tr class="row-even"><td><p>expr2</p></td>
<td><p>16x8 (see note)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>expr2s</p></td>
<td><p>16x8 (see note)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">*,</span> <span class="pre">/,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td><p>(signed for all except &lt;&lt;)</p></td>
</tr>
<tr class="row-even"><td><p>expr16</p></td>
<td><p>16x16</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>expr16s</p></td>
<td><p>16x16</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+,</span> <span class="pre">-,</span> <span class="pre">&amp;,</span> <span class="pre">|,</span> <span class="pre">^,</span> <span class="pre">&lt;&lt;,</span> <span class="pre">&gt;&gt;,</span> <span class="pre">=:</span></code></p></td>
<td><p>(signed &gt;&gt;)</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The expr2 macros support 16-bit literals as operands of + and -</p>
</div>
<p>For multiplication and division support you must initialize the internal functions with
one of the following:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Macro</p></th>
<th class="head"><p>Multiply</p></th>
<th class="head"><p>Divide</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>expr</p></td>
<td><p>use_expr_mul</p></td>
<td><p>use_expr_div</p></td>
</tr>
<tr class="row-odd"><td><p>exprs</p></td>
<td><p>use_expr_muls</p></td>
<td><p>use_expr_divs</p></td>
</tr>
<tr class="row-even"><td><p>expr2</p></td>
<td><p>use_expr_mul</p></td>
<td><p>use_expr_div16</p></td>
</tr>
<tr class="row-odd"><td><p>expr2s</p></td>
<td><p>use_expr_muls and use_expr_mulsu</p></td>
<td><p>use_expr_div16s</p></td>
</tr>
</tbody>
</table>
<p>As an expedient you can invoke <a class="reference internal" href="#pb.use_expr_all" title="use_expr_all"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_all()</span></code></a> to include all of them and then
eliminate any unused mul or div routines with the <code class="docutils literal notranslate"><span class="pre">--remove-dead-code</span></code> option to opbasm.</p>
<p>These macros need to be called before any call to expr*() that uses multiplication or division.
It is best to place them at the start of the program and jump over them to reach the startup code.
The stack must be configured with <a class="reference internal" href="#pb.use_stack" title="use_stack"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_stack()</span></code></a> before calling these macros because additional
modified registers must be saved and restored.</p>
<p>By default these macros configure the mul and div functions to use the s8,s9 or s7,s8, and s9
registers for input and output. You can modify the register allocation by passing arguments
to the use_* macros. The MSB of multiplication is ignored by subsequent operations. Division
by 0 is not detected.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.expr16">
<span class="sig-name descname"><span class="pre">expr16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr16" title="Permalink to this definition">¶</a></dt>
<dd><p>16x16 unsigned expression evaluator.
All terms are 16-bit register pairs or 16-bit literals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="m">2000</span> <span class="o">+</span> <span class="s">ry</span> <span class="o">*</span> <span class="m">3</span><span class="nb">)</span>  <span class="c">; (2000 + 400) * 3 =&gt; 12600</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.expr16s">
<span class="sig-name descname"><span class="pre">expr16s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr16s" title="Permalink to this definition">¶</a></dt>
<dd><p>16x16 signed expression evaluator.
All terms are 16-bit register pairs or 16-bit literals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="m">2000</span> <span class="o">+</span> <span class="s">ry</span> <span class="o">*</span> <span class="o">-</span><span class="m">3</span><span class="nb">)</span>  <span class="c">; (2000 + -400) * -3 =&gt; -4800</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.expr2">
<span class="sig-name descname"><span class="pre">expr2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr2" title="Permalink to this definition">¶</a></dt>
<dd><p>16x8 unsigned expression evaluator.
The target register is a 16-bit pair and the first term can be a 16-bit pair
or a 16-bit literal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="s">ry</span> <span class="o">+</span> <span class="m">200</span> <span class="o">*</span> <span class="m">3</span><span class="nb">)</span>  <span class="c">; (400 + 200) * 3 =&gt; 1800</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.expr2s">
<span class="sig-name descname"><span class="pre">expr2s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.expr2s" title="Permalink to this definition">¶</a></dt>
<dd><p>16x8 signed expression evaluator.
The target register is a 16-bit pair and the first term can be a 16-bit pair
or a 16-bit literal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s6</span><span class="p">,</span><span class="s">s7</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">ry</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="nb">expr2(</span><span class="s">rx</span> <span class="o">:=</span> <span class="s">ry</span> <span class="o">+</span> <span class="m">200</span> <span class="o">*</span> <span class="o">-</span><span class="m">3</span><span class="nb">)</span>  <span class="c">; (-400 + 200) * -3 =&gt; 600</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.exprs">
<span class="sig-name descname"><span class="pre">exprs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.exprs" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed 8-bit expression evaluator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register assignment expression of the form:
sN := &lt;val&gt; op &lt;val&gt; [op &lt;val&gt;]*</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.expr" title="expr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">expr()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.fetch16">
<span class="sig-name descname"><span class="pre">fetch16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.fetch16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit fetch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register of target</p></li>
<li><p><strong>Arg2</strong> – LSB register of target</p></li>
<li><p><strong>Arg3</strong> – Register pointing to low byte or MSB of source address when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB of source address</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to fetch.
It is incremented twice to permit sequential use of fetch16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of address constants to fetch from.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">M_ACCUM_L</span><span class="p">,</span> <span class="mh">1a</span>
<span class="k">constant</span> <span class="n">M_ACCUM_H</span><span class="p">,</span> <span class="mh">1b</span>
<span class="nb">reg16(</span><span class="s">M_ACCUM</span><span class="p">,</span> <span class="s">M_ACCUM_H</span><span class="p">,</span> <span class="s">M_ACCUM_L</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">M_ACCUM</span><span class="nb">)</span>  <span class="c">; Fetch direct from address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_ACCUM_L</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Fetch from indirect pointer</span>
<span class="nb">fetch16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Fetch next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.floor_log">
<span class="sig-name descname"><span class="pre">floor_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.floor_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute floor(log(n,b)) for Base-b.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Number to compute floor-log on</p></li>
<li><p><strong>Arg2</strong> – Logarithm base</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">floor_log(</span><span class="m">20</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>    <span class="c">; Expands to 4 (2**4 = 16, 2**5 = 32)</span>
<span class="nb">floor_log(</span><span class="m">1000</span><span class="p">,</span> <span class="m">10</span><span class="nb">)</span> <span class="c">; Expands to 3 (10**3 = 1000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.floor_log2">
<span class="sig-name descname"><span class="pre">floor_log2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.floor_log2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute floor(log(n)) for Base-2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Number to compute floor-log on</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">floor_log2(</span><span class="m">64</span><span class="nb">)</span> <span class="c">; Expands to 6</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.for">
<span class="sig-name descname"><span class="pre">for</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.for" title="Permalink to this definition">¶</a></dt>
<dd><p>For loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Initialization expression (passed to expr()). This can be empty.</p></li>
<li><p><strong>Arg2</strong> – Boolean comparison expression</p></li>
<li><p><strong>Arg3</strong> – Update expression (passed to expr()). This can be empty.</p></li>
<li><p><strong>Arg4</strong> – Code block for loop body</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">for(</span><span class="s">s0</span> <span class="o">:=</span> <span class="m">0</span><span class="p">,</span> <span class="s">s0</span> <span class="o">&lt;</span> <span class="m">5</span><span class="p">,</span> <span class="s">s0</span> <span class="o">:=</span> <span class="s">s0</span> <span class="o">+</span> <span class="m">1</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s0</span><span class="p">,</span> <span class="m">00</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
<p>Note:
The <a class="reference internal" href="#pb.continue" title="continue"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">continue()</span></code></a> macro will behave as in C by jumping to the update code before
restarting the loop.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.func">
<span class="sig-name descname"><span class="pre">func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.func" title="Permalink to this definition">¶</a></dt>
<dd><p>Function definition.</p>
<p>This creates a function that receives its arguments on the stack.
A macro is generated to prepare the stack arguments and call the function.
The function will save registers automatically and load the stack arguments.
The saved registers and call frame are cleaned up at the end.
Do not use <a class="reference internal" href="language.html#inst-return"><span class="std std-ref">return</span></a> instructions in the code body. Instead call the
leave_func() macro. Use the retvalue() macro to store return values
on the stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label for function</p></li>
<li><p><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</p></li>
<li><p><strong>Arg3</strong> – Number of bytes returned on stack (0 for no return values)</p></li>
<li><p><strong>Arg4</strong> – Code block for func body</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">func(</span><span class="s">mul</span><span class="p">,</span> <span class="s">`s0</span> <span class="s">is</span> <span class="s">m1</span><span class="p">,</span> <span class="s">s1</span> <span class="s">is</span> <span class="s">m2</span><span class="p">,</span> <span class="s">s2</span> <span class="s">is</span> <span class="s">result&#39;</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="s">`expr(result</span> <span class="o">:=</span> <span class="s">m1</span> <span class="o">*</span> <span class="s">m2</span><span class="nb">)</span>&#39;)
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.getstack">
<span class="sig-name descname"><span class="pre">getstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.getstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve multiple contiguous values from the stack without changing the stack pointer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Registers to save values in
The first register corresponds to the highest address</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">getstack(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Get stack offset SP+3, SP+2, and SP+1 into s3, s4, s5</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.getstackat">
<span class="sig-name descname"><span class="pre">getstackat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.getstackat" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve values from the stack without changing the stack pointer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to save value in</p></li>
<li><p><strong>Arg2</strong> – Offset from stack pointer (offset 1 is the first value) or a register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">getstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>  <span class="c">; Get the second value relative to the stack pointer</span>
<span class="nb">getstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; Get stack value pointed at by s0</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.if">
<span class="sig-name descname"><span class="pre">if</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <span class="optional">[</span><em class="sig-param"><span class="pre">Arg3</span></em>, <span class="optional">]</span><em class="sig-param"><span class="pre">Arg4-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.if" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic if macro.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Boolean comparison expression.</p></li>
<li><p><strong>Arg2</strong> – True clause</p></li>
<li><p><strong>Arg3</strong> – Optional else clause or next else-if comparison expression</p></li>
<li><p><strong>Arg4-ArgN</strong> – Additional else-if clauses</p></li>
</ul>
</dd>
</dl>
<p>The Boolean expression must be of the form: <code class="docutils literal notranslate"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;, &lt;=, &gt;=, ==, !=, &amp;, or ~&amp;
or of the form <code class="docutils literal notranslate"><span class="pre">reg</span></code> which is treated as <code class="docutils literal notranslate"><span class="pre">reg</span> <span class="pre">!=</span> <span class="pre">0</span></code>.</p>
<p>Signed comparison is invoked with <code class="docutils literal notranslate"><span class="pre">signed(comparison</span> <span class="pre">expr.)</span></code>
With signed comparison the right operand cannot be a named constant.</p>
<p>With the &amp; operator, a <a class="reference internal" href="language.html#inst-test"><span class="std std-ref">test</span></a> instruction is used in place of compare. The true
clause is executed when the result is non-zero (mask matches). The ~&amp; operator executes the
true clause when the test result is zero (no match).</p>
<p>This macro performs a comparison of the left and right operands and then inserts
the if* macro selected by the operation.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">if(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">02</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="nb">if(</span><span class="s">s0</span> <span class="o">!=</span> <span class="mh">0xa5</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="nb">if(signed(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="o">-</span><span class="m">10</span><span class="nb">)</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span> <span class="c">; Signed comparison with signed()</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ifeq">
<span class="sig-name descname"><span class="pre">ifeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-equals</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – True clause</p></li>
<li><p><strong>Arg2</strong> – Optional else clause</p></li>
</ul>
</dd>
</dl>
<p>These macros insert labels and <a class="reference internal" href="language.html#inst-jump"><span class="std std-ref">jump</span></a> instructions to implement the behavior of
an if-then or if-then-else statement testing for equality, inequality,
greater-or-equal, or less-than.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">ifeq(</span><span class="s">`load</span> <span class="s">s3</span><span class="p">,</span> <span class="m">20</span>
      <span class="s">output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">MY_PORT&#39;</span><span class="p">,</span>
<span class="s">;</span> <span class="s">else</span>
     <span class="s">`load</span> <span class="s">s3</span><span class="p">,</span> <span class="m">30</span>
      <span class="s">output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">MY_OTHER_PORT&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ifge">
<span class="sig-name descname"><span class="pre">ifge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifge" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-greater-or-equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – True clause</p></li>
<li><p><strong>Arg2</strong> – Optional else clause</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.iflt">
<span class="sig-name descname"><span class="pre">iflt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.iflt" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-less-than.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – True clause</p></li>
<li><p><strong>Arg2</strong> – Optional else clause</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.ifne">
<span class="sig-name descname"><span class="pre">ifne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.ifne" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level if-not-equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – True clause</p></li>
<li><p><strong>Arg2</strong> – Optional else clause</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.ifeq" title="ifeq"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">ifeq()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.input16">
<span class="sig-name descname"><span class="pre">input16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.input16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register of target</p></li>
<li><p><strong>Arg2</strong> – LSB register of target</p></li>
<li><p><strong>Arg3</strong> – Register pointing to low byte or MSB of source address when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB of source address</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a register pointing to the low port byte to read from.
It is incremented twice to permit sequential use of input16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of port constants to input from.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">P_ACCUM_L</span><span class="p">,</span> <span class="mh">1a</span>
<span class="k">constant</span> <span class="n">P_ACCUM_H</span><span class="p">,</span> <span class="mh">1b</span>
<span class="nb">reg16(</span><span class="s">P_ACCUM</span><span class="p">,</span> <span class="s">P_ACCUM_H</span><span class="p">,</span> <span class="s">P_ACCUM_L</span><span class="nb">)</span>
<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">P_ACCUM</span><span class="nb">)</span>  <span class="c">; Input direct from address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">P_ACCUM_L</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Input from indirect pointer</span>
<span class="nb">input16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Input next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.instdata">
<span class="sig-name descname"><span class="pre">instdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.instdata" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an INST directive from a pair of decimal values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – High 10-bits</p></li>
<li><p><strong>Arg2</strong> – Low byte</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">instdata(pbhex(</span><span class="mh">0A</span><span class="p">,</span> <span class="mh">0B</span><span class="nb">))</span>  <span class="c">; Expands to inst 00A0B</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.insttable_be">
<span class="sig-name descname"><span class="pre">insttable_be</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.insttable_be" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of data into a series of INST directives in big-endian byte order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Data to convert in decimal format</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">insttable_be(pbhex(</span><span class="mh">0a</span><span class="p">,</span> <span class="mh">0b</span><span class="p">,</span> <span class="mh">0c</span><span class="nb">))</span>
<span class="k">Expands</span> <span class="n">to</span>:  inst 00a0b
             <span class="k">inst</span> <span class="mh">00c00</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.insttable_le">
<span class="sig-name descname"><span class="pre">insttable_le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.insttable_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of data into a series of INST directives in little-endian byte order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Data to convert in decimal format</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">insttable_le(pbhex(</span><span class="mh">0a</span><span class="p">,</span> <span class="mh">0b</span><span class="p">,</span> <span class="mh">0c</span><span class="nb">))</span>
<span class="k">Expands</span> <span class="n">to</span>:  inst 00b0a
             <span class="k">inst</span> <span class="mh">0000c</span>

<span class="nb">insttable_le(asciiord(</span><span class="s">`Pack</span> <span class="s">strings</span> <span class="s">into</span> <span class="s">ROM&#39;</span><span class="nb">))</span>

  <span class="k">inst</span> <span class="mh">06150</span>
  <span class="k">inst</span> <span class="mh">06b63</span>
  <span class="k">inst</span> <span class="mh">07320</span>
  ...
  <span class="k">inst</span> <span class="mh">0206f</span>
  <span class="k">inst</span> <span class="mh">04f52</span>
  <span class="k">inst</span> <span class="mh">0004d</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.iodefs">
<span class="sig-name descname"><span class="pre">iodefs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.iodefs" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a series of contiguous port or scratchpad memory constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Starting address for port or memory</p></li>
<li><p><strong>Arg2-ArgN</strong> – Constant names</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">iodefs(</span><span class="m">0</span><span class="p">,</span> <span class="s">P_uart_out</span><span class="p">,</span> <span class="s">P_uart_in</span><span class="p">,</span> <span class="s">P_control</span><span class="nb">)</span>

<span class="k">Expands</span> <span class="n">to</span>:
  <span class="k">constant</span> <span class="n">P_uart_out</span><span class="p">,</span> <span class="mh">00</span>
  <span class="k">constant</span> <span class="n">P_uart_in</span><span class="p">,</span> <span class="mh">01</span>
  <span class="k">constant</span> <span class="n">P_control</span><span class="p">,</span> <span class="mh">02</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.isnum">
<span class="sig-name descname"><span class="pre">isnum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.isnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if argument is a number in m4 syntax.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There must be no leading or trailing whitespace.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to check</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 for true 0 for false</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">isnum(</span><span class="s">foo</span><span class="nb">)</span>  <span class="c">; Expands to 0</span>
<span class="nb">isnum(</span><span class="mh">0x42</span><span class="nb">)</span> <span class="c">; Expands to 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.isr">
<span class="sig-name descname"><span class="pre">isr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <span class="optional">[</span><em class="sig-param"><span class="pre">Arg3</span></em>, <span class="optional">]</span><em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.isr" title="Permalink to this definition">¶</a></dt>
<dd><p>ISR definition.</p>
<p>This creates an ISR that takes care of saving registers on the stack.
Do not use <a class="reference internal" href="language.html#inst-returni"><span class="std std-ref">returni</span></a> instructions in the code body. Instead call the
leave_func() macro.
By default the ISR returns with interrupts enabled. You can leave them
disabled by passing “disable” as Arg3.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Address for ISR</p></li>
<li><p><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</p></li>
<li><p><strong>Arg3</strong> – Optional return interrupt state “enable” | “disable” | empty</p></li>
<li><p><strong>Arg4</strong> – Code block for ISR body</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">isr(</span><span class="mh">0x3FF</span><span class="p">,</span> <span class="s">`s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2&#39;</span><span class="p">,</span> <span class="s">`load</span> <span class="s">s0</span><span class="p">,</span> <span class="m">42</span>
                          <span class="s">output</span> <span class="s">s0</span><span class="p">,</span> <span class="s">ff&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.jeq">
<span class="sig-name descname"><span class="pre">jeq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jeq" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to jump to</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">jeq(</span><span class="s">is_equal</span><span class="nb">)</span>   <span class="c">; jumps if s0 == s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.jge">
<span class="sig-name descname"><span class="pre">jge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jge" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if greater or equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to jump to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.jlt">
<span class="sig-name descname"><span class="pre">jlt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if less than.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to jump to</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="nb">jlt(</span><span class="s">less_than</span><span class="nb">)</span>  <span class="c">; jumps if s0 &lt; s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.jne">
<span class="sig-name descname"><span class="pre">jne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.jne" title="Permalink to this definition">¶</a></dt>
<dd><p>Jump if not equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to jump to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.leave_func">
<span class="sig-name descname"><span class="pre">leave_func</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.leave_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from func() macro code bodies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional condition code (Z, NZ, C, or NC)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">leave_func</span>
<span class="nb">leave_func(</span><span class="s">Z</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.leave_isr">
<span class="sig-name descname"><span class="pre">leave_isr</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.leave_isr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return from isr() macro code bodies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional condition code (Z, NZ, C, or NC)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">leave_isr(</span><span class="s">Z</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.load16">
<span class="sig-name descname"><span class="pre">load16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit load.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB destination register</p></li>
<li><p><strong>Arg2</strong> – LSB destination register</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or source MSB when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for source LSB</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit register pair copied to the destination.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>         <span class="c">; Load 16-bit literal</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">200</span> <span class="o">*</span> <span class="m">11</span> <span class="o">+</span> <span class="m">5</span><span class="nb">)</span> <span class="c">; Load 16-bit constant expresson</span>
<span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>       <span class="c">; Load 16-bits from a register pair</span>
<span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>               <span class="c">; Assuming rx and ry are reg16 definitions</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.load_out">
<span class="sig-name descname"><span class="pre">load_out</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load_out" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a register with a value and output to a port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Value to load (constant or other register)</p></li>
<li><p><strong>Arg2</strong> – Port to output to</p></li>
<li><p><strong>Arg3</strong> – Optional register to load with value, uses _tempreg if omitted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load_out(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x10</span><span class="nb">)</span>     <span class="c">; Write 0x5A to port 0x10 using _tempreg</span>
<span class="nb">load_out(</span><span class="mh">0x5A</span><span class="p">,</span> <span class="mh">0x10</span><span class="p">,</span> <span class="s">sA</span><span class="nb">)</span> <span class="c">; Write 0x5A to port 0x10 using sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.load_store">
<span class="sig-name descname"><span class="pre">load_store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.load_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a register with a value and store to scratchpad.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Value to load (constant or other register)</p></li>
<li><p><strong>Arg2</strong> – Scratchpad address to output to (constant or a register)</p></li>
<li><p><strong>Arg3</strong> – Optional Register to load with value, uses _tempreg if omitted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load_store(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x20</span><span class="nb">)</span>     <span class="c">; Store 0x42 at scratchpad address 0x20 using _tempreg</span>
<span class="nb">load_store(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x20</span><span class="p">,</span> <span class="s">sA</span><span class="nb">)</span> <span class="c">; Store 0x42 at scratchpad address 0x20 using sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.loadaddr">
<span class="sig-name descname"><span class="pre">loadaddr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.loadaddr" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a 16-bit address from a label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB destination register</p></li>
<li><p><strong>Arg2</strong> – LSB destination register</p></li>
<li><p><strong>Arg3</strong> – Address label</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nl">my_func:</span> <span class="k">return</span>
<span class="nb">loadaddr(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">my_func</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.mask">
<span class="sig-name descname"><span class="pre">mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a mask with specific bits set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Bit numbers to set in mask (0-7)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">mask(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">7</span><span class="nb">)</span>     <span class="c">; Expands to 135 = 0x87</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.maskh">
<span class="sig-name descname"><span class="pre">maskh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.maskh" title="Permalink to this definition">¶</a></dt>
<dd><p>Alternate mask that can be used as a direct argument to a PicoBlaze instruction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Bit numbers to set in mask (0-7)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A mask in PicoBlaze hex format</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">test</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">maskh(</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="nb">)</span> <span class="c">; Test if bits 3, 4, and 5 are clear</span>
<span class="k">jump</span> <span class="n">z</span><span class="p">,</span> <span class="n">is_clear</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.mem16">
<span class="sig-name descname"><span class="pre">mem16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.mem16" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a constant for 16-bit memory and port addresses.
This is similar to <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">reg16()</span></code></a> but it also generates
named constants with “_H” and “_L” suffixes for
byte access.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of constant</p></li>
<li><p><strong>Arg2</strong> – MSB address</p></li>
<li><p><strong>Arg3</strong> – LSB address</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">mem16(</span><span class="s">M_DATA</span><span class="p">,</span> <span class="mh">0x05</span><span class="p">,</span> <span class="mh">0x04</span><span class="nb">)</span> <span class="c">; Allocate scratchpad 05, 04 for use as M_DATA</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_DATA_L</span>  <span class="c">; load address 0x04</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">M_DATA_H</span>  <span class="c">; load address 0x05</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.negate">
<span class="sig-name descname"><span class="pre">negate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.negate" title="Permalink to this definition">¶</a></dt>
<dd><p>2s complement negation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to negate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result is in the same register</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">10&#39;d</span>
<span class="nb">negate(</span><span class="s">s0</span><span class="nb">)</span>     <span class="c">; Result is -10</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.negate16">
<span class="sig-name descname"><span class="pre">negate16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.negate16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit 2s-complement negation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to negate</p></li>
<li><p><strong>Arg2</strong> – LSB register to negate</p></li>
</ul>
</dd>
</dl>
<p>Result in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="o">-</span><span class="m">2600</span><span class="nb">)</span>
<span class="nb">negate16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>     <span class="c">; s1,s0 pair now contain +2600</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.nop">
<span class="sig-name descname"><span class="pre">nop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.nop" title="Permalink to this definition">¶</a></dt>
<dd><p>No-op macro.
Delay by one instruction without affecting processor state.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.not">
<span class="sig-name descname"><span class="pre">not</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.not" title="Permalink to this definition">¶</a></dt>
<dd><p>Logical not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to invert</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result is in the same register</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">5A</span>
<span class="nb">not(</span><span class="s">s0</span><span class="nb">)</span>     <span class="c">; Result is 0xA5</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.not16">
<span class="sig-name descname"><span class="pre">not16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.not16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to invert</p></li>
<li><p><strong>Arg2</strong> – LSB register to invert</p></li>
</ul>
</dd>
</dl>
<p>Result in Arg1, Arg2</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x8F5A</span><span class="nb">)</span>
<span class="nb">not16(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; s1,s0 pair now contain 0x70A5</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.or16">
<span class="sig-name descname"><span class="pre">or16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.or16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical OR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1</p></li>
<li><p><strong>Arg2</strong> – LSB1</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to OR to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x10F0</span><span class="nb">)</span>
<span class="nb">or16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x008F</span><span class="nb">)</span>   <span class="c">; Result is 0x10FF</span>
<span class="nb">or16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>    <span class="c">; (s1,s0) OR (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.output16">
<span class="sig-name descname"><span class="pre">output16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.output16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register of source</p></li>
<li><p><strong>Arg2</strong> – LSB register of source</p></li>
<li><p><strong>Arg3</strong> – Register pointing to low byte or MSB of output address when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB of output address</p></li>
</ul>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to output to.
It is incremented twice to permit sequential use of output16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of port address constants to output to.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">P_ACCUM</span><span class="nb">)</span>  <span class="c">; Output direct to port address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">P_ACCUM_L</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Output to indirect pointer</span>
<span class="nb">output16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Output next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.outputstring">
<span class="sig-name descname"><span class="pre">outputstring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.outputstring" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeated string output operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Output port in m4 integer format or a constant name</p></li>
<li><p><strong>Arg2</strong> – Register used to hold characters</p></li>
<li><p><strong>Arg3</strong> – String to split into characters</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">UART_PORT</span><span class="p">,</span> <span class="mh">0a</span>
<span class="nb">outputstring(</span><span class="s">UART_PORT</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">Expands</span> <span class="n">to</span>:
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;M&quot;</span>
   <span class="k">output</span> <span class="n">s1</span><span class="p">,</span> <span class="n">UART_PORT</span>
   <span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="sc">&quot;y&quot;</span>
   <span class="k">output</span> <span class="n">s1</span><span class="p">,</span> <span class="n">UART_PORT</span>
   ...

<span class="nb">outputstring(</span><span class="mh">0x0A</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">`My</span> <span class="s">string&#39;</span><span class="nb">)</span> <span class="c">; Without using a constant</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.outputtable">
<span class="sig-name descname"><span class="pre">outputtable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.outputtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a table of constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Output port in m4 integer format or a constant name</p></li>
<li><p><strong>Arg2</strong> – Temporary register for each constant</p></li>
<li><p><strong>Arg3-ArgN</strong> – Decimal values to output to port</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">UART_PORT</span><span class="p">,</span> <span class="mh">0a</span>
<span class="nb">outputtable(</span><span class="s">UART_PORT</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Output DE,AD,BE,EF to port</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.pb2m4">
<span class="sig-name descname"><span class="pre">pb2m4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pb2m4" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert PicoBlaze literals into m4 syntax. Performs the following conversions:</p>
<ul class="simple">
<li><p>Character literal to ASCII ordinal: <code class="docutils literal notranslate"><span class="pre">&quot;c&quot;</span> <span class="pre">-&gt;</span> <span class="pre">99</span></code></p></li>
<li><p>Decimal to integer: <code class="docutils literal notranslate"><span class="pre">20'd</span> <span class="pre">-&gt;</span> <span class="pre">20</span></code></p></li>
<li><p>Hex to integer: <code class="docutils literal notranslate"><span class="pre">5A</span> <span class="pre">-&gt;</span> <span class="pre">90</span></code></p></li>
<li><p>Binary to integer: <code class="docutils literal notranslate"><span class="pre">1100'b</span> <span class="pre">-&gt;</span> <span class="pre">12</span></code></p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to convert</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An integer in m4 syntax.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">pb2m4(</span><span class="m">10</span><span class="s">&#39;d</span><span class="nb">)</span> <span class="k">expands</span> <span class="n">to</span> <span class="mh">10</span><span class="p">,</span>  <span class="nb">pb2m4(</span><span class="s">&quot;0&quot;</span><span class="nb">)</span> <span class="n">expands</span> <span class="n">to</span> <span class="mh">48</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.pbhex">
<span class="sig-name descname"><span class="pre">pbhex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pbhex" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of values in PicoBlaze hex format to decimal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Hex values to convert</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">pbhex(</span><span class="mh">01</span><span class="p">,</span> <span class="mh">02</span><span class="p">,</span> <span class="mh">03</span><span class="p">,</span> <span class="mh">0a</span><span class="p">,</span> <span class="mh">ff</span><span class="nb">)</span>  <span class="c">; Expands to 1, 2, 3, 10, 255</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Pop register values from a simulated stack in scratchpad RAM.</p>
<p>Arguments should be passed in the same order as push() to restore register contents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Registers with values to pop</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.push" title="push"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">push()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.popvars">
<span class="sig-name descname"><span class="pre">popvars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.popvars" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove definitions from previous call to vars().</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.proc">
<span class="sig-name descname"><span class="pre">proc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.proc" title="Permalink to this definition">¶</a></dt>
<dd><p>Procedure definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label for procedure</p></li>
<li><p><strong>Arg2</strong> – Variable definitions (same format as passed to the vars() macro)</p></li>
<li><p><strong>Arg3</strong> – Code block for proc body</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">proc(</span><span class="s">add2</span><span class="p">,</span> <span class="s">`s0</span> <span class="s">is</span> <span class="s">result&#39;</span><span class="p">,</span> <span class="s">`add</span> <span class="s">result</span><span class="p">,</span> <span class="m">02</span><span class="s">&#39;</span><span class="nb">)</span>
...
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">42</span>
<span class="k">call</span> <span class="mh">add2</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Push register values onto a simulated stack in scratchpad RAM.</p>
<p>The stack pointer grows from the end of the scratchpad to the start.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Registers with values to push</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_stack(</span><span class="s">sa</span><span class="p">,</span> <span class="mh">0x3F</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s0</span><span class="nb">)</span>
<span class="nb">pop(</span><span class="s">s1</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span>  <span class="c">; Push and pop multiple registers at once</span>
<span class="nb">pop(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span>   <span class="c">; Pop is performed in reverse order from push</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.putstack">
<span class="sig-name descname"><span class="pre">putstack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.putstack" title="Permalink to this definition">¶</a></dt>
<dd><p>Store multiple contiguous values on the stack without changing the stack pointer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Registers to store values from
The first register corresponds to the highest address</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">putstack(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Put s3, s4, s5 into stack offset SP+3, SP+2, and SP+1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.putstackat">
<span class="sig-name descname"><span class="pre">putstackat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.putstackat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store values to the stack without changing the stack pointer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register with value to store</p></li>
<li><p><strong>Arg2</strong> – Offset from stack pointer (offset 1 is the first value) or a register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">putstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>  <span class="c">; Put the second value relative to the stack pointer</span>
<span class="nb">putstackat(</span><span class="s">s3</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; Put stack value pointed at by s0</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.qstr">
<span class="sig-name descname"><span class="pre">qstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.qstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add double quotes around a string.
This is allows the use of macros to generate strings where substitution within “” would
normally be suppressed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to quote</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">define(</span><span class="s">DATE_STAMP</span><span class="p">,</span> <span class="s">`1</span> <span class="s">Jan</span> <span class="m">2015</span><span class="s">&#39;</span><span class="nb">)</span>
<span class="k">string</span> <span class="n">mystr$</span><span class="p">,</span> <span class="nb">qstr(</span><span class="s">DATE_STAMP</span><span class="nb">)</span>  <span class="c">; Expands to string mystr$, &quot;1 Jan 2015&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.randlabel">
<span class="sig-name descname"><span class="pre">randlabel</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.randlabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a random name for a label.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional prefix to name</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">randlabel(</span><span class="s">PREFIX_</span><span class="nb">)</span> <span class="c">; Expands to &quot;__PREFIX_?????&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.reg16">
<span class="sig-name descname"><span class="pre">reg16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reg16" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a virtual 16-bit register.
The defined name can be used in place of the MSB, LSB pairs used in other 16-bit macros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of virtual register</p></li>
<li><p><strong>Arg2</strong> – MSB register</p></li>
<li><p><strong>Arg3</strong> – LSB register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span> <span class="c">; rx = (s1, s0)</span>
<span class="nb">reg16(</span><span class="s">ry</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span> <span class="c">; ry = (s5, s4)</span>
<span class="nb">add16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>     <span class="c">; rx = rx + ry</span>
<span class="nb">add16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span> <span class="c">; rx = rx + (s3, s2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.reglower">
<span class="sig-name descname"><span class="pre">reglower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reglower" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lower register from a <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">reg16()</span></code></a> or <a class="reference internal" href="#pb.mem16" title="mem16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">mem16()</span></code></a> definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB of 16-bit register pair</p></li>
<li><p><strong>Arg2</strong> – LSB of 16-bit register pair</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pb.regupper" title="regupper"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">regupper()</span></code></a> for more information.</p>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.regupper">
<span class="sig-name descname"><span class="pre">regupper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.regupper" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the upper register from a <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">reg16()</span></code></a> or <a class="reference internal" href="#pb.mem16" title="mem16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">mem16()</span></code></a> definition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB of 16-bit register pair</p></li>
<li><p><strong>Arg2</strong> – LSB of 16-bit register pair</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="nb">regupper(</span><span class="s">rx</span><span class="nb">)</span> <span class="c">; load upper byte from s5 (rx expands to &quot;s5,s4&quot;)</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="nb">reglower(</span><span class="s">rx</span><span class="nb">)</span> <span class="c">; load lower byte from s4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.repeat">
<span class="sig-name descname"><span class="pre">repeat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.repeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat an instruction or macro.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Instruction or macro string to repeat</p></li>
<li><p><strong>Arg2</strong> – Numper of repetitions</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">repeat(</span><span class="s">`output</span> <span class="s">s0</span><span class="p">,</span> <span class="m">00</span><span class="s">&#39;</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.repeatstr">
<span class="sig-name descname"><span class="pre">repeatstr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.repeatstr" title="Permalink to this definition">¶</a></dt>
<dd><p>Repeat a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Instruction or macro string to repeat</p></li>
<li><p><strong>Arg2</strong> – Numper of repetitions</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">repeat(</span><span class="s">`A&#39;</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span> <span class="c">; Expands to &quot;AAA&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.reteq">
<span class="sig-name descname"><span class="pre">reteq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.reteq" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if equal.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">compare</span> <span class="n">s0</span><span class="p">,</span> <span class="n">s1</span>
<span class="k">reteq</span>   <span class="c">; return if s0 == s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.retge">
<span class="sig-name descname"><span class="pre">retge</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if greater or equal.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.retlt">
<span class="sig-name descname"><span class="pre">retlt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if less than.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.retne">
<span class="sig-name descname"><span class="pre">retne</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.retne" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if not equal.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.retvalue">
<span class="sig-name descname"><span class="pre">retvalue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.retvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Place func return value onto the stack.</p>
<p>Only call this macro inside a func code body</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register with value to save</p></li>
<li><p><strong>Arg2</strong> – Offset from end of return frame (starting at 1)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">retvalue(</span><span class="s">s0</span><span class="p">,</span> <span class="m">1</span><span class="nb">)</span> <span class="c">; First return value to be popped off after return</span>
<span class="nb">retvalue(</span><span class="s">s1</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span> <span class="c">; Second value to return from func</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.reverse">
<span class="sig-name descname"><span class="pre">reverse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.reverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverse arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – List of arguments to reverse</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reverse(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="nb">)</span> <span class="c">; Expands to 3,2,1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.rl">
<span class="sig-name descname"><span class="pre">rl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rl" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit rotate left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to rotate</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">rl(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Rotate left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.rl16">
<span class="sig-name descname"><span class="pre">rl16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rl16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit rotate left.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to rotate</p></li>
<li><p><strong>Arg2</strong> – LSB register to rotate</p></li>
<li><p><strong>Arg3</strong> – Number of bits to rotate (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.rr">
<span class="sig-name descname"><span class="pre">rr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rr" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit rotate right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to rotate</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">rr(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Rotate right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.rr16">
<span class="sig-name descname"><span class="pre">rr16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.rr16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit rotate right.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to rotate</p></li>
<li><p><strong>Arg2</strong> – LSB register to rotate</p></li>
<li><p><strong>Arg3</strong> – Number of bits to rotate (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.setbit">
<span class="sig-name descname"><span class="pre">setbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.setbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Set and clear bits in a register.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to modify</p></li>
<li><p><strong>Arg2</strong> – Bit number (0-7) to set or clear</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">setbit(</span><span class="s">s0</span><span class="p">,</span> <span class="m">2</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.setcy">
<span class="sig-name descname"><span class="pre">setcy</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.setcy" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the carry flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional temporary register to modify. Uses temp register by default.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">setcy</span>
<span class="nb">setcy(</span><span class="s">sF</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.setmask">
<span class="sig-name descname"><span class="pre">setmask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.setmask" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mask bits in a register.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to modify</p></li>
<li><p><strong>Arg2</strong> – Mask value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">setmask(</span><span class="s">s5</span><span class="p">,</span> <span class="nb">mask(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="nb">))</span>
<span class="nb">setmask(</span><span class="s">s4</span><span class="p">,</span> <span class="mh">0xF1</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.signed">
<span class="sig-name descname"><span class="pre">signed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.signed" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a Boolean expression to use signed comparison.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Expression to convert</p></li>
</ul>
</dd>
</dl>
<p>This is used in the expression passed to the if(), for(), while(), and dowhile()
macros to invoke signed comparison.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">signed(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Expands to &quot;s0 s&lt; 4&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.signex">
<span class="sig-name descname"><span class="pre">signex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.signex" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign extension.</p>
<p>This extends the sign from an 8-bit number into a new register producing a 16-bit result.
The argument order allows you to use this with virtual registers created with <a class="reference internal" href="#pb.reg16" title="reg16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">reg16()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to extend sign into (MSB)</p></li>
<li><p><strong>Arg2</strong> – Register to test for sign bit (LSB)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">81</span>     <span class="c">; Sign bit is set</span>
<span class="nb">signex(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>  <span class="c">; s1 now contains 0xFF</span>

<span class="nb">reg16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>
<span class="k">load</span> <span class="nb">reglower(</span><span class="s">rx</span><span class="nb">)</span><span class="p">,</span> <span class="mh">82</span>
<span class="nb">signex(</span><span class="s">rx</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sl0">
<span class="sig-name descname"><span class="pre">sl0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl0" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with ‘0’ insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sl0(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sl0_16">
<span class="sig-name descname"><span class="pre">sl0_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl0_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift left, inserting ‘0’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sl1">
<span class="sig-name descname"><span class="pre">sl1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl1" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with ‘1’ insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sl1(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sl1_16">
<span class="sig-name descname"><span class="pre">sl1_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sl1_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift left, inserting ‘1’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sla">
<span class="sig-name descname"><span class="pre">sla</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sla" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with C insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sla(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sla_16">
<span class="sig-name descname"><span class="pre">sla_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sla_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit arithmetic shift left, inserting C flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.slx">
<span class="sig-name descname"><span class="pre">slx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.slx" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift left with LSB sign extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">slx(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift left by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.slx_16">
<span class="sig-name descname"><span class="pre">slx_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.slx_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit sign extending shift left, duplicating LSB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sr0">
<span class="sig-name descname"><span class="pre">sr0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr0" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with ‘0’ insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sr0(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sr0_16">
<span class="sig-name descname"><span class="pre">sr0_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr0_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift right, inserting ‘0’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sr1">
<span class="sig-name descname"><span class="pre">sr1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr1" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with ‘1’ insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sr1(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sr1_16">
<span class="sig-name descname"><span class="pre">sr1_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sr1_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit shift right, inserting ‘1’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sra">
<span class="sig-name descname"><span class="pre">sra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sra" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with C insert.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sra(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sra_16">
<span class="sig-name descname"><span class="pre">sra_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.sra_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit arithmetic shift right, inserting C flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.srx">
<span class="sig-name descname"><span class="pre">srx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.srx" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-bit shift right with MSB sign extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to shift</p></li>
<li><p><strong>Arg2</strong> – Number of shifts</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">srx(</span><span class="s">s2</span><span class="p">,</span> <span class="m">4</span><span class="nb">)</span>  <span class="c">; Shift right by 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.srx_16">
<span class="sig-name descname"><span class="pre">srx_16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.srx_16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit sign extending shift right, duplicating MSB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register to shift</p></li>
<li><p><strong>Arg2</strong> – LSB register to shift</p></li>
<li><p><strong>Arg3</strong> – Number of bits to shift (0-16)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.store16">
<span class="sig-name descname"><span class="pre">store16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.store16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit store.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB register of source</p></li>
<li><p><strong>Arg2</strong> – LSB register of source</p></li>
<li><p><strong>Arg3</strong> – Register pointing to low byte or MSB of target address when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB of target address</p></li>
</ul>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a register pointing to the low byte to store to.
It is incremented twice to permit sequential use of store16().
When four arguments are passed, Arg3 and Arg4 are a 16-bit pair of address constants to store to.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">rx</span><span class="p">,</span> <span class="m">2014</span><span class="nb">)</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">M_ACCUM</span><span class="nb">)</span>  <span class="c">; Store direct to address</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_ACCUM_L</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Store to indirect pointer</span>
<span class="nb">store16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">s0</span><span class="nb">)</span>       <span class="c">; Store next word</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.storestring">
<span class="sig-name descname"><span class="pre">storestring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.storestring" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a string to scratchpad RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Address of first byte</p></li>
<li><p><strong>Arg2</strong> – String to store</p></li>
<li><p><strong>Arg3</strong> – Optional register to load each character, uses _tempreg if omitted</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">storestring(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">`Hello&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.storestringat">
<span class="sig-name descname"><span class="pre">storestringat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.storestringat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a string to scratchpad RAM using a register address.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Pointer register to scratchpad address</p></li>
<li><p><strong>Arg2</strong> – String to store</p></li>
<li><p><strong>Arg3</strong> – Optional register to load each character, uses _tempreg if omitted</p></li>
</ul>
</dd>
</dl>
<p>The pointer register will finish with the address of the last character in the string.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="n">M_BUFFER</span>
<span class="nb">storestringat(</span><span class="s">s0</span><span class="p">,</span> <span class="s">`Hello&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.storetable">
<span class="sig-name descname"><span class="pre">storetable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.storetable" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a table of constants in scratchpad RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Address of first byte</p></li>
<li><p><strong>Arg2</strong> – Temporary register for each constant</p></li>
<li><p><strong>Arg3-ArgN</strong> – Decimal values to load in scratchpad</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">my_array</span>
<span class="nb">storetable(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Load DE,AD,BE,EF into memory</span>
<span class="nb">storetable(</span><span class="mh">0x10</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="nb">)</span>         <span class="c">; Load decimals</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.storetableat">
<span class="sig-name descname"><span class="pre">storetableat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.storetableat" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a table of constants in scratchpad RAM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Pointer register to scratchpad address</p></li>
<li><p><strong>Arg2</strong> – Temporary register for each constant</p></li>
<li><p><strong>Arg3-ArgN</strong> – Decimal values to load in scratchpad</p></li>
</ul>
</dd>
</dl>
<p>The pointer register will finish with the address of the last byte in the table.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="n">my_array</span>
<span class="nb">storetableat(</span><span class="s">s1</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="nb">pbhex(</span><span class="mh">DE</span><span class="p">,</span><span class="mh">AD</span><span class="p">,</span><span class="mh">BE</span><span class="p">,</span><span class="mh">EF</span><span class="nb">))</span> <span class="c">; Load DE,AD,BE,EF into memory</span>
<span class="nb">storetableat(</span><span class="s">s1</span><span class="p">,</span> <span class="s">sF</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="nb">)</span>         <span class="c">; Load decimals</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.strhash">
<span class="sig-name descname"><span class="pre">strhash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.strhash" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a 16-bit checksum constant from a string using the BSD algorithm.
This does not dynamically compute a hash from variable data. It can be used to seed a PRNG
from a build time string like a timestamp.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to compute hash over</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">strhash(</span><span class="s">`Hello</span> <span class="s">world&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 27566</span>

<span class="nb">reg16(</span><span class="s">RS</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>
<span class="nb">load16(</span><span class="s">RS</span><span class="p">,</span> <span class="nb">strhash(</span><span class="s">DATE_STAMP</span> <span class="s">TIME_STAMP</span><span class="nb">))</span> <span class="c">; Seed the PRNG with the build time</span>
<span class="k">call</span> <span class="n">random16</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.strlenc">
<span class="sig-name descname"><span class="pre">strlenc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.strlenc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the length of a string constant, a portable string or a packed string.
The argument is passed through the <a class="reference internal" href="#pb.estr" title="estr"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">estr()</span></code></a> macro to collapse escaped characters
before counting them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – String to count length from. This is either a constant or the label to a string
defined with string() or packed_string()</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">strlenc(</span><span class="s">`foobar\r\n&#39;</span><span class="nb">)</span>  <span class="c">; Expands to 8</span>

<span class="nb">packed_string(</span><span class="s">xyzzy</span><span class="p">,</span> <span class="s">`This</span> <span class="s">is</span> <span class="s">a</span> <span class="s">string&#39;</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="nb">strlenc(</span><span class="s">xyzzy</span><span class="nb">)</span> <span class="c">; Expands to 16</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.sub16">
<span class="sig-name descname"><span class="pre">sub16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.sub16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit subtraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1 register</p></li>
<li><p><strong>Arg2</strong> – LSB1 register</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to add to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">sub16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span> <span class="c">; s1,s0 -= 0x1234</span>
<span class="nb">sub16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>  <span class="c">; s1,s0 -= s3,s2</span>
<span class="nb">sub16(</span><span class="s">rx</span><span class="p">,</span> <span class="s">ry</span><span class="nb">)</span>        <span class="c">; rx    -= ry</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.swap" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap registers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register 1</p></li>
<li><p><strong>Arg2</strong> – Register 2</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">swap(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span> <span class="c">; s1 -&gt; s0 and s0 -&gt; s1</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.test16">
<span class="sig-name descname"><span class="pre">test16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.test16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1</p></li>
<li><p><strong>Arg2</strong> – LSB1</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to use with the TEST comparison.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">On</span> <span class="n">PicoBlaze</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">only</span> <span class="n">the</span> <span class="n">Z</span> <span class="n">flag</span> <span class="ow">is</span> <span class="nb">set</span> <span class="n">properly</span><span class="o">.</span> <span class="n">On</span> <span class="n">PicoBlaze</span><span class="o">-</span><span class="mi">6</span> <span class="n">the</span> <span class="n">C</span> <span class="n">flag</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">XOR</span>
<span class="p">(</span><span class="n">odd</span> <span class="n">parity</span><span class="p">)</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">bits</span><span class="o">.</span>
</pre></div>
</div>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x10F0</span><span class="nb">)</span>
<span class="nb">test16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0080</span><span class="nb">)</span>  <span class="c">; Z flag is clear</span>
<span class="nb">test16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x0800</span><span class="nb">)</span>  <span class="c">; Z flag is set</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.testbit">
<span class="sig-name descname"><span class="pre">testbit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.testbit" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a bit is set or clear.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to test</p></li>
<li><p><strong>Arg2</strong> – Bit number (0-7) to test</p></li>
</ul>
</dd>
</dl>
<p>Z is set if bit is clear, Z is clear if bit is set</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">testbit(</span><span class="s">s1</span><span class="p">,</span> <span class="m">3</span><span class="nb">)</span>
<span class="k">jump</span> <span class="n">z</span><span class="p">,</span> <span class="n">bit_cleared</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.uniqlabel">
<span class="sig-name descname"><span class="pre">uniqlabel</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.uniqlabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a unique name for a label.
The labels will be unique to each included file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional prefix to name</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">uniqlabel(</span><span class="s">PREFIX_</span><span class="nb">)</span> <span class="c">; Expands to &quot;__PREFIX_f0_0001&quot;</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_ascii2bcd">
<span class="sig-name descname"><span class="pre">use_ascii2bcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_ascii2bcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an ASCII number to BCD.
Invalid characters are converted to “0” digits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the ASCII data</p></li>
<li><p><strong>Arg3</strong> – Register for length of the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_ascii2bcd(</span><span class="s">ascii2bcd</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Array address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Length</span>
<span class="k">call</span> <span class="n">ascii2bcd</span>
<span class="c">; The array now contains all BCD digits</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_bcd2int">
<span class="sig-name descname"><span class="pre">use_bcd2int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em>, <em class="sig-param"><span class="pre">Arg7</span></em>, <em class="sig-param"><span class="pre">Arg8</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_bcd2int" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an unpacked BCD coded bytes to a
variable size integer.</p>
<p>The BCD input is stored in a buffer in
scratchpad memory. The buffer address and length are passed as arguments.
The converted result is overwritten to the leftmost portion of the buffer.
The length register returns with the number of bytes in the result.
This function handles conversion to any size integer as the result is
guaranteed to be smaller than the initial buffer.
Internal temp registers must be allocated for use by the macro. They must
not include the _tempreg register.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – First argument of generated function.
Register with scratchpad BCD address</p></li>
<li><p><strong>Arg3</strong> – Register with number of bytes for scratchpad buffer</p></li>
<li><p><strong>Arg4</strong> – Internal temp register</p></li>
<li><p><strong>Arg5</strong> – Internal temp register</p></li>
<li><p><strong>Arg6</strong> – Internal temp register</p></li>
<li><p><strong>Arg7</strong> – Internal temp register</p></li>
<li><p><strong>Arg8</strong> – Internal temp register</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted integer value is located at the start of the buffer with the LSB
first, opposite to the order of the BCD digits.
The number of bytes in the converted integer is returned in the second argument
to the function (Arg3 of this generator macro). All other registers are preserved
on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_bcd2int(</span><span class="s">bcd2int</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span><span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="p">,</span><span class="s">s6</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; BCD buffer</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">03</span> <span class="c">; 3 BCD digits long</span>
<span class="k">call</span> <span class="n">bcd2int</span>
<span class="c">; s1 contains the number of converted bytes</span>
<span class="c">; scratchpad 20 (and possibly 21) contain the binary result</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_bcdwrite">
<span class="sig-name descname"><span class="pre">use_bcdwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_bcdwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array of BCD coded bytes to an output port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source BCD data</p></li>
<li><p><strong>Arg3</strong> – Register for number of bytes to write</p></li>
<li><p><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_bcdwrite(</span><span class="s">bcdwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">bcdwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_clock">
<span class="sig-name descname"><span class="pre">use_clock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_clock" title="Permalink to this definition">¶</a></dt>
<dd><p>Define system clock frequency.</p>
<p><strong>Only invoke once. Must be executed before any delay macros.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Clock frequency in MHz. Limited to integer values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_delay_reg">
<span class="sig-name descname"><span class="pre">use_delay_reg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_delay_reg" title="Permalink to this definition">¶</a></dt>
<dd><p>Define delay loop register.</p>
<p><strong>Only invoke once. Must be executed before any delay macros.</strong>
This register must be different from the registers used in the delay_us() and delay_ms() macros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to use for inner loop counter</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_delay_reg(</span><span class="s">sA</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_divide16x8">
<span class="sig-name descname"><span class="pre">use_divide16x8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em>, <em class="sig-param"><span class="pre">Arg7</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg8</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide16x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 16 / 8 subroutine. Implements truncating division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Dividend MSB</p></li>
<li><p><strong>Arg3</strong> – Dividend LSB</p></li>
<li><p><strong>Arg4</strong> – Divisor</p></li>
<li><p><strong>Arg5</strong> – Quotient MSB</p></li>
<li><p><strong>Arg6</strong> – Quotient LSB</p></li>
<li><p><strong>Arg7</strong> – Remainder</p></li>
<li><p><strong>Arg8</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The MSB of the dividend is destroyed.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_divide16x8(</span><span class="s">div16</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; (s3,s4) (rem s5) &lt;= (s0,s1) / s2</span>
<span class="nb">load16(</span><span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="m">400</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="m">5&#39;d</span>
<span class="k">call</span> <span class="n">div16</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_divide16x8s">
<span class="sig-name descname"><span class="pre">use_divide16x8s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em>, <em class="sig-param"><span class="pre">Arg7</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg8</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide16x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Divide 16 / 8 subroutine. Implements truncating division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Dividend MSB (signed)</p></li>
<li><p><strong>Arg3</strong> – Dividend LSB</p></li>
<li><p><strong>Arg4</strong> – Divisor      (signed)</p></li>
<li><p><strong>Arg5</strong> – Quotient MSB (signed)</p></li>
<li><p><strong>Arg6</strong> – Quotient LSB</p></li>
<li><p><strong>Arg7</strong> – Remainder</p></li>
<li><p><strong>Arg8</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The MSB of the dividend is destroyed.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_divide16x8s(</span><span class="s">div16</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; (s3,s4) (rem s5) &lt;= (s0,s1) / s2</span>
<span class="nb">load16(</span><span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="p">,</span> <span class="o">-</span><span class="m">400</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="m">5&#39;d</span>
<span class="k">call</span> <span class="n">div16</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_divide8x8">
<span class="sig-name descname"><span class="pre">use_divide8x8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 8 / 8 subroutine. Implements truncating division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Dividend</p></li>
<li><p><strong>Arg3</strong> – Divisor</p></li>
<li><p><strong>Arg4</strong> – Quotient</p></li>
<li><p><strong>Arg5</strong> – Remainder</p></li>
<li><p><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_divide8x8(</span><span class="s">div8</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="nb">)</span> <span class="c">; s2 (rem s3) &lt;= s0 / s1</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">20&#39;d</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="m">4&#39;d</span>
<span class="k">call</span> <span class="n">div8</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_divide8x8s">
<span class="sig-name descname"><span class="pre">use_divide8x8s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Divide 8 / 8 subroutine. Implements truncating division.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Dividend (signed)</p></li>
<li><p><strong>Arg3</strong> – Divisor (signed)</p></li>
<li><p><strong>Arg4</strong> – Quotient</p></li>
<li><p><strong>Arg5</strong> – Remainder</p></li>
<li><p><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>Same arguments as unsigned 8 / 8 divide.
.. seealso:: <a class="reference internal" href="#pb.use_divide8x8" title="use_divide8x8"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_divide8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_divide8xk">
<span class="sig-name descname"><span class="pre">use_divide8xk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_divide8xk" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide 8 / constant subroutine with 8-bit result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Dividend</p></li>
<li><p><strong>Arg3</strong> – Constant divisor (can be wider than 8-bits)</p></li>
<li><p><strong>Arg4</strong> – Result quotient</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_divide8xk(</span><span class="s">div8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; s4 = s0 / 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">30&#39;d</span>
<span class="k">call</span> <span class="n">div8k5</span>    <span class="c">; 30 / 5 =&gt; 6</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_all">
<span class="sig-name descname"><span class="pre">use_expr_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure all multiplication and divide subroutines.
Use this in conjunction with Opbasm’s dead code removal to guarantee that
only the arithmetic subroutines in use will be assembled.
This is equivalent to calling the following macros with no arguments:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pb.use_expr_mul" title="use_expr_mul"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_mul()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_muls" title="use_expr_muls"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_muls()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_mulsu" title="use_expr_mulsu"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_mulsu()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_div" title="use_expr_div"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_div()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_divs" title="use_expr_divs"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_divs()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_div16" title="use_expr_div16"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_div16()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pb.use_expr_div16s" title="use_expr_div16s"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_expr_div16s()</span></code></a></p></li>
</ul>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_div">
<span class="sig-name descname"><span class="pre">use_expr_div</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned division for expressions.
All arguments are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional Dividend (default is s8)</p></li>
<li><p><strong>Arg2</strong> – Optional Divisor  (default is s9)</p></li>
<li><p><strong>Arg3</strong> – Optional Internal result Quotient (default is sA) preserved on stack</p></li>
<li><p><strong>Arg4</strong> – Optional Internal result Remainder (default is sB) preserved on stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result is copied to Arg1, Arg2</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_div16">
<span class="sig-name descname"><span class="pre">use_expr_div16</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div16" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned 16x8 division for expressions. This creates a new function “expr_div16”
used by the expr2() macro.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional MSB of Dividend (default is s7)</p></li>
<li><p><strong>Arg2</strong> – Optional LSB of Dividend (default is s8)</p></li>
<li><p><strong>Arg3</strong> – Optional Divisor  (default is s9)</p></li>
<li><p><strong>Arg4</strong> – Optional MSB of Quotient (default is sA)</p></li>
<li><p><strong>Arg5</strong> – Optional LSB of Quotient (default is sB)</p></li>
<li><p><strong>Arg6</strong> – Optional Remainder (default is sC)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function places the quotient in Arg1,Arg2 and the remainder in Arg3.</p>
</dd>
</dl>
<p>Arg4-6 act as temp registers and are restored
from the stack.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_div16s">
<span class="sig-name descname"><span class="pre">use_expr_div16s</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_div16s" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed 16x8 division for expressions. This creates a new function “expr_div16s”
used by the expr2s() macro.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional MSB of Dividend (default is s7)</p></li>
<li><p><strong>Arg2</strong> – Optional LSB of Dividend (default is s8)</p></li>
<li><p><strong>Arg3</strong> – Optional Divisor  (default is s9)</p></li>
<li><p><strong>Arg4</strong> – Optional MSB of Quotient (default is sA)</p></li>
<li><p><strong>Arg5</strong> – Optional LSB of Quotient (default is sB)</p></li>
<li><p><strong>Arg6</strong> – Optional Remainder (default is sC)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function places the quotient in Arg1,Arg2 and the remainder in Arg3.</p>
</dd>
</dl>
<p>Arg4-6 act as temp registers and are restored
from the stack.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_divs">
<span class="sig-name descname"><span class="pre">use_expr_divs</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_divs" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed division for expressions.
All arguments are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional Dividend (default is s8)</p></li>
<li><p><strong>Arg2</strong> – Optional Divisor  (default is s9)</p></li>
<li><p><strong>Arg3</strong> – Optional Internal result Quotient (default is sA) preserved on stack</p></li>
<li><p><strong>Arg4</strong> – Optional Internal result Remainder (default is sB) preserved on stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result is copied to Arg1, Arg2</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_mul">
<span class="sig-name descname"><span class="pre">use_expr_mul</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure unsigned multiplication for expressions.
All arguments are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional Multiplicand (default is s8)</p></li>
<li><p><strong>Arg2</strong> – Optional Multiplier   (default is s9)</p></li>
<li><p><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</p></li>
<li><p><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result is copied to Arg1, Arg2</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_muls">
<span class="sig-name descname"><span class="pre">use_expr_muls</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_muls" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signed multiplication for expressions.
All arguments are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional Multiplicand (default is s8)</p></li>
<li><p><strong>Arg2</strong> – Optional Multiplier   (default is s9)</p></li>
<li><p><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</p></li>
<li><p><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result is copied to Arg1, Arg2</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_expr_mulsu">
<span class="sig-name descname"><span class="pre">use_expr_mulsu</span></span><span class="sig-paren">(</span><span class="optional">[</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_expr_mulsu" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure signedxunsigned (16x8) multiplication for expressions.
All arguments are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Optional Multiplicand (default is s8)</p></li>
<li><p><strong>Arg2</strong> – Optional Multiplier   (default is s9)</p></li>
<li><p><strong>Arg3</strong> – Optional Internal result MSB (default is sA) preserved on stack</p></li>
<li><p><strong>Arg4</strong> – Optional Internal result LSB (default is sB) preserved on stack</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result is copied to Arg1, Arg2</p>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_hexwrite">
<span class="sig-name descname"><span class="pre">use_hexwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_hexwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array to an output port as ASCII hex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source data</p></li>
<li><p><strong>Arg3</strong> – Register for number of bytes to write</p></li>
<li><p><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_hexwrite(</span><span class="s">hexwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">hexwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_int2bcd">
<span class="sig-name descname"><span class="pre">use_int2bcd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em>, <em class="sig-param"><span class="pre">Arg7</span></em>, <em class="sig-param"><span class="pre">Arg8</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_int2bcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to convert an integer to unpacked BCD coded
bytes stored in a scratchpad buffer.</p>
<p>The number to convert is passed on the stack as one or more bytes
with the MSB pushed last. The buffer size is fixed after generating
the function. You must ensure it is large enough to contain the
largest integer you expect to convert. Each buffer byte corresponds to
one decimal digit. The converted BCD number is right justified within
the buffer with leading 0’s for padding. The least significant digit
is always at the end of the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Number of bytes for scratchpad buffer (fixed constant)</p></li>
<li><p><strong>Arg3</strong> – First argument of generated function.
Register with destination scratchpad address</p></li>
<li><p><strong>Arg4</strong> – Register containing number of bytes of data to convert
on the stack</p></li>
<li><p><strong>Arg5</strong> – Internal temp register</p></li>
<li><p><strong>Arg6</strong> – Internal temp register</p></li>
<li><p><strong>Arg7</strong> – Internal temp register</p></li>
<li><p><strong>Arg8</strong> – Internal temp register</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_int2bcd(</span><span class="s">int2bcd</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">s5</span><span class="nb">)</span> <span class="c">; Support up to 5 decimal digits</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Dest address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">02</span> <span class="c">; Convert 16-bit number (2-bytes)</span>
<span class="nb">load16(</span><span class="s">s4</span><span class="p">,</span><span class="s">s3</span><span class="p">,</span> <span class="m">31337</span><span class="nb">)</span>
<span class="nb">push(</span><span class="s">s3</span><span class="p">,</span><span class="s">s4</span><span class="nb">)</span> <span class="c">; Put number to convert on stack; LSB then MSB</span>
<span class="k">call</span> <span class="n">int2bcd</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_memcopy">
<span class="sig-name descname"><span class="pre">use_memcopy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to copy an array in scratchpad memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source array</p></li>
<li><p><strong>Arg3</strong> – Register for destination address</p></li>
<li><p><strong>Arg4</strong> – Register for number of bytes to copy</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_memcopy(</span><span class="s">memcopy</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">30</span> <span class="c">; Dest address</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Copy 5 bytes</span>
<span class="k">call</span> <span class="n">memcopy</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_memset">
<span class="sig-name descname"><span class="pre">use_memset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memset" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to set an array in scratchpad memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the destination array</p></li>
<li><p><strong>Arg3</strong> – Register for number of bytes to copy</p></li>
<li><p><strong>Arg4</strong> – Register for value to set array bytes to</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_memset(</span><span class="s">memset</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Destination address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Copy 5 bytes</span>
<span class="k">load</span> <span class="n">s2</span><span class="p">,</span> <span class="mh">00</span> <span class="c">; Set all bytes to 0</span>
<span class="k">call</span> <span class="n">memset</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_memwrite">
<span class="sig-name descname"><span class="pre">use_memwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_memwrite" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a function to write an array of bytes to an output port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Name of function to generate</p></li>
<li><p><strong>Arg2</strong> – Register for first function argument,
the scratchpad address of the source array</p></li>
<li><p><strong>Arg3</strong> – Register for number of bytes to write</p></li>
<li><p><strong>Arg4</strong> – Port address to write. This is a fixed value that can’t
be changed at runtime</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated function has no return value. All registers are
preserved on the stack.</p>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">constant</span> <span class="n">ConsolePort</span><span class="p">,</span> <span class="mh">FE</span>
<span class="nb">use_memwrite(</span><span class="s">memwrite</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">ConsolePort</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">20</span> <span class="c">; Source address</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span> <span class="c">; Write 5 bytes</span>
<span class="k">call</span> <span class="n">memwrite</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_multiply8x8">
<span class="sig-name descname"><span class="pre">use_multiply8x8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x 8 subroutine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Multiplicand</p></li>
<li><p><strong>Arg3</strong> – Multiplier</p></li>
<li><p><strong>Arg4</strong> – Result MSB</p></li>
<li><p><strong>Arg5</strong> – Result LSB</p></li>
<li><p><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>The temp register is overwritten. It is sE by default. Call use_tempreg(reg_name)
before invoking this macro to change it. The optional code block can be used to insert
initialization code at the beginning of the generated subroutine. The final <code class="docutils literal notranslate"><span class="pre">return</span></code> is
omitted so that you can also append finalization code. You must provide an explicit <code class="docutils literal notranslate"><span class="pre">return</span></code>
when the preamble block is in use.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_multiply8x8(</span><span class="s">mul8</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span> <span class="s">s2</span><span class="nb">)</span> <span class="c">; (s3, s2) = s0 * s1</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">04</span>
<span class="k">load</span> <span class="n">s1</span><span class="p">,</span> <span class="mh">05</span>
<span class="k">call</span> <span class="n">mul8</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_multiply8x8s">
<span class="sig-name descname"><span class="pre">use_multiply8x8s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8s" title="Permalink to this definition">¶</a></dt>
<dd><p>Signed Multiply 8 x 8 subroutine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Multiplicand (signed)</p></li>
<li><p><strong>Arg3</strong> – Multiplier (signed)</p></li>
<li><p><strong>Arg4</strong> – Result MSB</p></li>
<li><p><strong>Arg5</strong> – Result LSB</p></li>
<li><p><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>Same arguments as unsigned multiply. Both arguments are treated as signed numbers.
.. seealso:: <a class="reference internal" href="#pb.use_multiply8x8" title="use_multiply8x8"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_multiply8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_multiply8x8su">
<span class="sig-name descname"><span class="pre">use_multiply8x8su</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8x8su" title="Permalink to this definition">¶</a></dt>
<dd><p>SignedxUnsigned Multiply 8 x 8 subroutine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Multiplicand (signed)</p></li>
<li><p><strong>Arg3</strong> – Multiplier (unsigned)</p></li>
<li><p><strong>Arg4</strong> – Result MSB</p></li>
<li><p><strong>Arg5</strong> – Result LSB</p></li>
<li><p><strong>Arg6</strong> – Optional preamble code block. Also supresses return statement if present.</p></li>
</ul>
</dd>
</dl>
<p>Same arguments as unsigned multiply. Only the multiplicand is treated as signed.
.. seealso:: <a class="reference internal" href="#pb.use_multiply8x8" title="use_multiply8x8"><code class="xref pb pb-macro docutils literal notranslate"><span class="pre">use_multiply8x8()</span></code></a> for more information.</p>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_multiply8xk">
<span class="sig-name descname"><span class="pre">use_multiply8xk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8xk" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x constant subroutine with 16-bit result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Multiplicand</p></li>
<li><p><strong>Arg3</strong> – Constant multiplier (can be wider than 8-bits)</p></li>
<li><p><strong>Arg4</strong> – Result MSB</p></li>
<li><p><strong>Arg5</strong> – Result LSB</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_multiply8xk(</span><span class="s">mul8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; (s5, s4) = s0 * 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">7&#39;d</span>
<span class="k">call</span> <span class="n">mul8k5</span>   <span class="c">; 7 * 5 =&gt; 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_multiply8xk_small">
<span class="sig-name descname"><span class="pre">use_multiply8xk_small</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_multiply8xk_small" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply 8 x constant subroutine with 8-bit result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Subroutine name</p></li>
<li><p><strong>Arg2</strong> – Multiplicand</p></li>
<li><p><strong>Arg3</strong> – Constant multiplier</p></li>
<li><p><strong>Arg4</strong> – Result byte</p></li>
</ul>
</dd>
</dl>
<p>It is your responsibility to ensure that the result doesn’t overflow the
size of a byte.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_multiply8xk_small(</span><span class="s">mul8k5</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="s">s4</span><span class="nb">)</span>  <span class="c">; s4 = s0 * 5</span>
<span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="m">7&#39;d</span>
<span class="k">call</span> <span class="n">mul8k5</span>  <span class="c">; 7 * 5 =&gt; 35</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_packed_strings">
<span class="sig-name descname"><span class="pre">use_packed_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em>, <em class="sig-param"><span class="pre">Arg6</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg7</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_packed_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure packed string handling.</p>
<p>This uses string data packed into INST statements stored in big-endian order.
You must provide a routine to read pairs of characters from a dual-ported memory.
The packed_string() macro calls into a generic handler routine that
scans for a NUL terminator on data read from an external ROM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to store even characters</p></li>
<li><p><strong>Arg2</strong> – Register to store odd characters</p></li>
<li><p><strong>Arg3</strong> – Register for MSB of address to string</p></li>
<li><p><strong>Arg4</strong> – Register for LSB of address to string</p></li>
<li><p><strong>Arg5</strong> – Label of user provided function to process each character (Only needs to handle the even char register)</p></li>
<li><p><strong>Arg6</strong> – Label of user provided function to read pairs of characters from memory</p></li>
<li><p><strong>Arg7</strong> – Optional name of macro to generate strings (default is “packed_string”)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_packed_strings(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s1</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">write_char</span><span class="p">,</span> <span class="s">read_next_chars</span><span class="nb">)</span>
<span class="c">; read_next_chars is called until a NUL is found</span>
<span class="c">; write_char is called for each character stored in s0</span>
</pre></div>
</div>
<p>This generates a new macro with the name used for Arg7.
You must take steps to ensure that the normal execution path skips the
instructions generated by this macro.
It takes the following arguments:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label used to identify string</p></li>
<li><p><strong>Arg2</strong> – String value. This can contain all of the escape chars supported by estr/cstr</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">jump</span> <span class="n">main</span>
    <span class="nb">packed_string(</span><span class="s">my_string</span><span class="p">,</span> <span class="s">`Hello</span><span class="p">,</span> <span class="s">World!\r\n&#39;</span><span class="nb">)</span>
<span class="nl">main:</span>
...
    <span class="k">call</span> <span class="n">my_string</span> <span class="c">; Output the string</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_random16">
<span class="sig-name descname"><span class="pre">use_random16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_random16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit pseudo-random number generator.
Based on George Marsaglia’s xorshift algorithm. This generates a full cycle of 65535 values.
Expands to 23 instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label to use for random function</p></li>
<li><p><strong>Arg2</strong> – MSB of 16-bit random state variable (Initialize this with a non-zero seed)</p></li>
<li><p><strong>Arg3</strong> – LSB of 16-bit random state variable (Initialize this with a non-zero seed)</p></li>
<li><p><strong>Arg4</strong> – MSB of a 16-bit internal temp register</p></li>
<li><p><strong>Arg5</strong> – LSB of a 16-bit internal temp register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">reg16(</span><span class="s">RS</span><span class="p">,</span> <span class="s">s0</span><span class="p">,</span><span class="s">s1</span><span class="nb">)</span>
<span class="nb">use_random16(</span><span class="s">random</span><span class="p">,</span> <span class="s">RS</span><span class="p">,</span> <span class="s">sA</span><span class="p">,</span> <span class="s">sB</span><span class="nb">)</span>
...
<span class="nb">load16(</span><span class="s">RS</span><span class="p">,</span> <span class="mh">0x1234</span><span class="nb">)</span>   <span class="c">; Seed the PRNG (Use an external entropy source like an ADC in real life)</span>
<span class="k">call</span> <span class="n">random</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_random8">
<span class="sig-name descname"><span class="pre">use_random8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_random8" title="Permalink to this definition">¶</a></dt>
<dd><p>8-bit pseudo-random number generator.
Based on George Marsaglia’s xorshift algorithm. Generates a full cycle of 255 values.
Expands to 11 instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – label to use for random function</p></li>
<li><p><strong>Arg2</strong> – Random state variable (Initialize this with a non-zero seed)</p></li>
</ul>
</dd>
</dl>
<p>The common temp register is destructively modified.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">namereg</span> <span class="n">s8</span><span class="p">,</span> <span class="n">RS</span>
<span class="nb">use_random8(</span><span class="s">random</span><span class="p">,</span> <span class="s">RS</span><span class="nb">)</span>
...
<span class="k">load</span> <span class="n">RS</span><span class="p">,</span> <span class="mh">5A</span>   <span class="c">; Seed the PRNG (Use an external entropy source like an ADC in real life)</span>
<span class="k">call</span> <span class="n">random</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_stack">
<span class="sig-name descname"><span class="pre">use_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize and define stack pointer register.</p>
<p><strong>Only invoke once. Must be executed before any push() or pop() macros</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Stack pointer register</p></li>
<li><p><strong>Arg2</strong> – Scratchpad address for top of stack</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">namereg</span> <span class="n">sA</span><span class="p">,</span> <span class="n">SP</span>      <span class="c">; Reserve stack pointer register</span>
<span class="nb">use_stack(</span><span class="s">SP</span><span class="p">,</span> <span class="mh">0x3F</span><span class="nb">)</span> <span class="c">; Start stack at end of 64-byte scratchpad</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_strings">
<span class="sig-name descname"><span class="pre">use_strings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg5</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_strings" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure string handling for either PB3 or PB6.</p>
<p>This will set up a string output function for either platform
On PB6, the string() macro calls into a generic handler routine that
scans for a NUL terminator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to store each character</p></li>
<li><p><strong>Arg2</strong> – Register for MSB of address to string (Only used on PB6)</p></li>
<li><p><strong>Arg3</strong> – Register for LSB of address to string (Only used on PB6)</p></li>
<li><p><strong>Arg4</strong> – Label of user provided function to process each character</p></li>
<li><p><strong>Arg5</strong> – Optional name of macro to generate strings (default is “string”)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_strings(</span><span class="s">s0</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span><span class="s">s4</span><span class="p">,</span> <span class="s">write_char</span><span class="nb">)</span>
  <span class="c">; write_char is called for each character stored in s0 using the &quot;string()&quot; macro</span>
<span class="nb">use_strings(</span><span class="s">s1</span><span class="p">,</span> <span class="s">s5</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span> <span class="s">write_char_to_console</span><span class="p">,</span> <span class="s">console_str</span><span class="nb">)</span>
  <span class="c">; write_char_to_console is called for each character stored in s1 using the &quot;console_str()&quot; macro</span>
</pre></div>
</div>
<p>This generates a new macro with the name used for Arg5.
You must take steps to ensure that the normal execution path skips the
instructions generated by this macro.
It takes the following arguments:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Label used to identify string</p></li>
<li><p><strong>Arg2</strong> – String value. This can contain all of the escape chars supported by estr/cstr</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">jump</span> <span class="n">main</span>
    <span class="nb">string(</span><span class="s">my_string</span><span class="p">,</span> <span class="s">`Hello</span><span class="p">,</span> <span class="s">World!\r\n&#39;</span><span class="nb">)</span>
<span class="nl">main:</span>
...
    <span class="k">call</span> <span class="n">my_string</span> <span class="c">; Output the string</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.use_tempreg">
<span class="sig-name descname"><span class="pre">use_tempreg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.use_tempreg" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a common temporary register used by other macros.
This allows you to change the temp register from its default of <code class="docutils literal notranslate"><span class="pre">sE</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Register to use for temp register</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">use_tempreg(</span><span class="s">sA</span><span class="nb">)</span>
<span class="k">load</span> <span class="n">_tempreg</span><span class="p">,</span> <span class="mh">01</span> <span class="c">; Puts 0x01 into sA</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.var_count_ms">
<span class="sig-name descname"><span class="pre">var_count_ms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_count_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 16-bit millisecond count for variable delay macro var_delay_ms().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Milliseconds to delay</p></li>
<li><p><strong>Arg2</strong> – Max milliseconds for the delay loop (from definition using var_delay_ms())</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.var_count_us">
<span class="sig-name descname"><span class="pre">var_count_us</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_count_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate 16-bit microsecond count for variable delay macro var_delay_us().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Microseconds to delay</p></li>
<li><p><strong>Arg2</strong> – Max microseconds for the delay loop (from definition using var_delay_us())</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.var_delay_ms">
<span class="sig-name descname"><span class="pre">var_delay_ms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_delay_ms" title="Permalink to this definition">¶</a></dt>
<dd><p>Variable delay by milliseconds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Maximum milliseconds to delay</p></li>
<li><p><strong>Arg2</strong> – MSB of delay counter</p></li>
<li><p><strong>Arg3</strong> – LSB of delay counter</p></li>
</ul>
</dd>
</dl>
<p>The var_count_ms() macro generates a 16-bit count value that is loaded
into the counter registers before calling the delay function.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
 <span class="nb">define(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="m">10</span><span class="nb">)</span> <span class="c">; 10ms max delay</span>
 <span class="nb">reg16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>

<span class="nl">delay:</span> <span class="nb">var_delay_ms(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="s">dly_count</span><span class="nb">)</span>
       <span class="k">return</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_ms(</span><span class="m">1</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 1 ms</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_ms(</span><span class="m">8</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 8 ms</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.var_delay_us">
<span class="sig-name descname"><span class="pre">var_delay_us</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.var_delay_us" title="Permalink to this definition">¶</a></dt>
<dd><p>Variable delay by microseconds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Maximum microseconds to delay</p></li>
<li><p><strong>Arg2</strong> – MSB of delay counter</p></li>
<li><p><strong>Arg3</strong> – LSB of delay counter</p></li>
</ul>
</dd>
</dl>
<p>The var_count_us() macro generates a 16-bit count value that is loaded
into the counter registers before calling the delay function.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span> <span class="nb">use_clock(</span><span class="m">50</span><span class="nb">)</span> <span class="c">; 50 MHz clock</span>
 <span class="nb">define(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="m">900</span><span class="nb">)</span> <span class="c">; 900 us max delay</span>
 <span class="nb">reg16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="s">s4</span><span class="p">,</span><span class="s">s5</span><span class="nb">)</span>

<span class="nl">delay:</span> <span class="nb">var_delay_us(</span><span class="s">MAXDELAY</span><span class="p">,</span> <span class="s">dly_count</span><span class="nb">)</span>
       <span class="k">return</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_us(</span><span class="m">100</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 100 us</span>
...
<span class="nb">load16(</span><span class="s">dly_count</span><span class="p">,</span> <span class="nb">var_count_us(</span><span class="m">800</span><span class="p">,</span> <span class="s">MAXDELAY</span><span class="nb">))</span>
<span class="k">call</span> <span class="n">delay</span> <span class="c">; Delay for 800 us</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.vars">
<span class="sig-name descname"><span class="pre">vars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Define variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Series of variable alias expressions where an alias expression is:
&lt;reg&gt; is &lt;alias&gt; [:= value]</p></li>
</ul>
</dd>
</dl>
<p>The alias becomes an alternate name for the register. It is loaded with a value if the
optional initializer is included. The value can be any constant expression or register.
Use the popvars() macro to remove the variable definitions.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">vars(</span><span class="s">s0</span> <span class="s">is</span> <span class="s">counter</span> <span class="o">:=</span> <span class="m">0</span><span class="p">,</span> <span class="s">s1</span> <span class="s">is</span> <span class="s">sum</span><span class="p">,</span> <span class="s">s2</span> <span class="s">is</span> <span class="s">max</span> <span class="o">:=</span> <span class="m">20</span><span class="o">*</span><span class="m">3</span><span class="nb">)</span>
<span class="c">; s0 is loaded with 0</span>
<span class="c">; s2 is loaded with 60</span>
<span class="c">; Three macros &quot;counter&quot;, &quot;sum&quot;, and &quot;max&quot; will expand into their registers</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.warnmsg">
<span class="sig-name descname"><span class="pre">warnmsg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.warnmsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a warning message and continue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – message string</p></li>
</ul>
</dd>
</dl>
<p>This prints a message with the file and line number where the macro was invoked for debugging.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">warnmsg(</span><span class="s">`Bad</span> <span class="s">arguments</span> <span class="s">to</span> <span class="s">foo</span> <span class="s">macro&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.while">
<span class="sig-name descname"><span class="pre">while</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.while" title="Permalink to this definition">¶</a></dt>
<dd><p>While loop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – Boolean comparison expression</p></li>
<li><p><strong>Arg2</strong> – Code block for loop body</p></li>
</ul>
</dd>
</dl>
<p>The Boolean expression must be of the form: <code class="docutils literal notranslate"><span class="pre">reg</span> <span class="pre">op</span> <span class="pre">reg|expression</span></code> where op is &lt;, &gt;=, ==, !=, &amp;, or ~&amp;</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="k">load</span> <span class="n">s0</span><span class="p">,</span> <span class="mh">00</span>
<span class="nb">while(</span><span class="s">s0</span> <span class="o">&lt;</span> <span class="m">10</span><span class="p">,</span> <span class="s">`output</span> <span class="s">s3</span><span class="p">,</span> <span class="s">P_foo</span>
                <span class="s">add</span> <span class="s">s0</span><span class="p">,</span> <span class="m">01</span><span class="s">&#39;</span><span class="nb">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.words_be">
<span class="sig-name descname"><span class="pre">words_be</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.words_be" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 16-bit words into bytes with big-endian order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Numbers to split into bytes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">words_be(</span><span class="mh">0xff01</span><span class="p">,</span> <span class="mh">0xff02</span><span class="nb">)</span> <span class="c">; Expands to 1, 255, 2, 255</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.words_le">
<span class="sig-name descname"><span class="pre">words_le</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1-ArgN</span></em><span class="sig-paren">)</span><a class="headerlink" href="#pb.words_le" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert 16-bit words into bytes with little-endian order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1-ArgN</strong> – Numbers to split into bytes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">words_le(</span><span class="mh">0xff01</span><span class="p">,</span> <span class="mh">0xff02</span><span class="nb">)</span> <span class="c">; Expands to 255, 1, 255, 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="pb macro">
<dt class="sig sig-object pb" id="pb.xor16">
<span class="sig-name descname"><span class="pre">xor16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">Arg1</span></em>, <em class="sig-param"><span class="pre">Arg2</span></em>, <em class="sig-param"><span class="pre">Arg3</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">Arg4</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#pb.xor16" title="Permalink to this definition">¶</a></dt>
<dd><p>16-bit logical XOR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Arg1</strong> – MSB1</p></li>
<li><p><strong>Arg2</strong> – LSB1</p></li>
<li><p><strong>Arg3</strong> – Decimal constant or expression or MSB2 when Arg4 is present</p></li>
<li><p><strong>Arg4</strong> – Optional register for LSB2</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Result in Arg1, Arg2</p>
</dd>
</dl>
<p>When three arguments are passed, Arg3 is a constant literal. When four arguments are passed,
Arg3 and Arg4 are a 16-bit pair to XOR to the result.</p>
<p class="rubric">Example:</p>
<div class="highlight-picoblaze notranslate"><div class="highlight"><pre><span></span><span class="nb">load16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0x5A01</span><span class="nb">)</span>
<span class="nb">xor16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="mh">0xF0FF</span><span class="nb">)</span>   <span class="c">; Result is 0xAAFE</span>
<span class="nb">xor16(</span><span class="s">s1</span><span class="p">,</span><span class="s">s0</span><span class="p">,</span> <span class="s">s3</span><span class="p">,</span><span class="s">s2</span><span class="nb">)</span>    <span class="c">; (s1,s0) XOR (s3,s2)</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/opbasm_logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">Opbasm</a></h1>



<p class="blurb">Advanced PicoBlaze Assembler</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=kevinpt&repo=opbasm&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="opbsim.html" title="previous chapter">Opbsim</a></li>
  </ul></li>
</ul>
</div><h3>Other projects</h3>

<div id="proj_list">
<p>

<a href="http://kevinpt.github.io/ripyl/">Ripyl</a><br>
<a href="http://code.google.com/p/vertcl">Vertcl</a><br>
<a href="http://code.google.com/p/vhdl-extras">Vhdl-extras</a><br>
<a href="http://kevinpt.github.io/lecroy-colorizer/">Lecroy-colorizer</a>
</p>
</div>

<script>
$(function() { // Retrieve list of repositories from Github and dynamically insert them into sidebar

if(!window.sessionStorage || !JSON) { return; } // Punt on crusty browsers (looking at you IE10)

function JSONP( url, callback ) {
	var id = ( 'jsonp' + Math.random() * new Date() ).replace('.', '');
	var script = document.createElement('script');
	script.src = url.replace( 'callback=?', 'callback=' + id );
	document.body.appendChild( script );
	window[ id ] = function( data ) {
		if (callback) {
			callback( data );
		}
	};
}

// Build dictionary indexing lower cased project names with their preferred format
var knownProjects = ["VHDL-extras", "Ripyl", "VerTcl", "LeCroy-colorizer", "Opbasm"];
var projectDict = {};
$.each(knownProjects, function(index, v) {
  projectDict[v.toLowerCase()] = v;
});

function insert_projects(projects) {
    var links = [];
    var cur_proj = "Opbasm".toLowerCase();
    
    $.each(projects, function(key, value) {
      if(key != cur_proj) {
        var title;
        if(key in projectDict) {
          title = projectDict[key];
        } else { // Capitalize first char
          title = key.replace(/^./, function(match) {return match.toUpperCase()});
        }
        links.push("<a href='"+ value +"'>" + title + "</a>");
      }
    });
    
    $("#proj_list").html("<p>"+ links.join("<br>") +"</p>");
}

var now = new Date().getTime();
if(sessionStorage.KTcacheTime && now - sessionStorage.KTcacheTime < 5*60*1000 ) { // Use cached values (5 min. expiry)
  insert_projects(JSON.parse(sessionStorage.KTprojects));
} else { // Retrieve current projects
  JSONP("https://api.github.com/users/kevinpt/repos?type=owner&callback=?", function(response) {
    var projects = {};
    $.each(response.data, function(index, value) {
      if(!value.fork)
        projects[value.name] = value.homepage;
    });
    
    insert_projects(projects);
    
    // Store data in session cache
    sessionStorage.KTprojects = JSON.stringify(projects);
    var now = new Date().getTime();
    sessionStorage.KTcacheTime = now;
  });  
}

});
</script>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Kevin Thibedeau.
      
      |
      <a href="../_sources/rst/library.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>